#!/bin/bash
#
. i_config

# Funcionalidad no implementada
#==> * Listar horizontal y inftical
#==> * pedir los resultados como HTML

#	cat ${var}html_cabecera.txt
#	cat ${var}html_separador.txt
#	cat ${var}html_final.txt

##***********************************************************************************************##
## HOLA!
##***********************************************************************************************##

if [ "$1" = "hola" ]
then

	echo " objetivo: Reponder preguntas comunes"

##***********************************************************************************************##
## Muestra el SCHEMA de una TABLA
##***********************************************************************************************##
#@ inf sch BASE TABLA                          -- Muestra el SCHEMA de la TABLA "TABLA" de BASE

elif [ "$1" = "sch" ]
then

	pgsql_consultar $2 "\d $3"

##***********************************************************************************************##
## Lista las tablas cuayo nombre empiza con 'apl_' en BASE
##***********************************************************************************************##
#@ inf apl BASE                                -- Lista TABLAS 'apl_' en BASE

elif [ "$1" = "apl" ]
then

	pgsql_consultar $2 "SELECT relname as TABLAS FROM pg_class WHERE relowner <> 1 AND relkind = 'r' AND relname ~* 'apl_' ORDER BY 1;"

##***********************************************************************************************##
## Muestra el contenido de una tabla
##***********************************************************************************************##
#@ inf tabla BASE TABLA                        -- Muestra el contenido de TABLA  en BASE

elif [ "$1" = "tabla" ]
then

	pgsql_consultar $2  "SELECT * FROM $3;"

##***********************************************************************************************##
## inf ITEMs del CATALOGO
##***********************************************************************************************##
#@ inf item BASE                               -- Busqueda de items del catalogo

elif [ "$1" = "item" ]
then

	pgsql_consultar $2 "SELECT * FROM apl_item ORDER BY item;"


##***********************************************************************************************##
## inf ITEMs del CATALOGO
##***********************************************************************************************##
#@ inf log BASE                                -- Muesta los LOGs del sistema

elif [ "$1" = "log" ]
then

	echo "APL_LOG_ERROR_LOGIN"
	pgsql_consultar $2 "SELECT * FROM apl_log_error_login;"
	echo
	echo "APL_LOG_IP_RECHAZADA"
	pgsql_consultar $2 "SELECT * FROM apl_log_ip_rechazada;"
	echo
	echo "APL_LOG_SISTEMA"
	pgsql_consultar $2 "SELECT * FROM apl_log_sistema;"
	echo

##***********************************************************************************************##
## inf ITEMs del CATALOGO
##***********************************************************************************************##
#@ inf sol BASE                                -- Muestra solicitudes realizadas

elif [ "$1" = "sol" ]
then

	echo "APL_SESION_BROWSER"
	pgsql_consultar $2 "SELECT * FROM apl_sesion_browser;"
	echo
	echo "APL_SOLICITUD"
	pgsql_consultar $2 "SELECT * FROM apl_solicitud;"
	echo
	echo "APL_SOLICITUD_CONSOLA"
	pgsql_consultar $2 "SELECT * FROM apl_solicitud_consola;"
	echo
	echo "APL_SOLICITUD_BROWSER"
	pgsql_consultar $2 "SELECT * FROM apl_solicitud_browser;"
	echo
	echo "APL_SOLICITUD_OBSERVACION"
	pgsql_consultar $2 "SELECT * FROM apl_solicitud_observacion;"
	echo
	echo "APL_SOLICITUD_OBJ_OBSERVACION"
	pgsql_consultar $2 "SELECT * FROM apl_solicitud_obj_observacion;"
	echo
	echo "APL_SOLICITUD_CRONOMETRO"
#	pgsql_consultar $2 "SELECT * FROM apl_solicitud_cronometro;"
	echo

##***********************************************************************************************##
## inf USUARIOS de la aplicacion
##***********************************************************************************************##
#@ inf usuarios BASE                           -- Busqueda de items del catalogo

elif [ "$1" = "usuarios" ]
then

	echo "APL_SESION_BROWSER"
	pgsql_consultar $2 "SELECT usuario, clave FROM apl_usuario;"

##***********************************************************************************************##
## inf Fuentes de datos del sistema
##***********************************************************************************************##
#@ inf fuentes BASE                            -- Busqueda de items del catalogo

elif [ "$1" = "fuentes" ]
then

	echo "apl_fuente_datos"
	pgsql_consultar $2 "SELECT fuente_datos, fuente_datos_motor, host, usuario, clave, proyecto FROM apl_fuente_datos;"

##***********************************************************************************************##
## inf Fuentes de datos del sistema
##***********************************************************************************************##
## inf catalogo BASE                           -- Busqueda de items del catalogo

elif [ "$1" = "his" ]
then

	query="hola"
	for a in `cat $d_bin/inc/tablas_his`
	do
		echo $a
		query = "$query SELECT * FROM $a;"
	done
	echo $query	
          

##***********************************************************************************************##
## inf Cosas Pendientes
##***********************************************************************************************##
elif [ "$1" = "pendiente" ]
then
	pendiente $0

##***********************************************************************************************##
## Ayuda
##***********************************************************************************************##
else
	ayuda $0
fi
