#!/bin/bash
#
. i_config

TITLE="Toba API"
PACKAGES="Toba"
PATH_PROJECT=$toba_dir/php/nucleo/componentes/runtime
PATH_PHPDOC=$toba_dir/php/3ros/phpdocumentor/phpdoc
PATH_DOCS=$toba_dir/doc/api
OUTPUTFORMAT=HTML
CONVERTER=Smarty
TEMPLATE=HandS
PRIVATE=off
# IGNORADOS - Persistencia
IGNORADOS="db_registros*.php,db_tablas.php"
# IGNORADOS - Clases
IGNORADOS="$IGNORADOS,__*.php,eventos.php,objeto_ci_abm.php,objeto_cuadro*.php,objeto_esquema*.php,objeto_filtro.php,objeto_grafico.php,objeto_hoja*.php,objeto_mt*.php,objeto_ut*.php,objeto_plan.php,objeto_lista.php,objeto_mapa.php,objeto_ei_multicheq.php"


##***********************************************************************************************##
## HOLA!
##***********************************************************************************************##

if [ "$1" = "hola" ]
then

	echo " objetivo: Administrar la documentación del API y Wiki."

##***********************************************************************************************##
## Genera la documentación del API
##***********************************************************************************************##
#@ doc api                  -- Genera la documentación del api, con salida en $toba_dir/doc/api

elif [ "$1" = "api" ]
then	

	if [ -e $PATH_PHPDOC ]
	then
		#rm -R --force $PATH_DOCS
		$PATH_PHPDOC -d $PATH_PROJECT -t $PATH_DOCS -ti "$TITLE" -dn $PACKAGES \
		-o $OUTPUTFORMAT:$CONVERTER:$TEMPLATE -pp $PRIVATE -i $IGNORADOS -ct "wiki"
	else
		echo "No está instalado phpDocumentor, vea el archivo $toba_dir/php/3ros/phpdocumentor.txt"
	fi


##***********************************************************************************************##
## Generar la documentación del WIKI
##***********************************************************************************************##
#@ doc wiki                 -- Baja la documentación online del wiki utilizando httracker

elif [ "$1" = "wiki" ]
then	
	httrack "https://desarrollos2.siu.edu.ar/trac/toba/wiki" -v  -%h -%F "" -I0 -N100 -x %P -O "$toba_dir/www/doc/wiki" \
		+*.png +*.gif +*.jpg +*.css +*.js  -*login* -*changeset* -*timeline* -*browse* -*roadmap* \
		-*report* -*search* -*history* -*format* -*settings*  -*about* -*ticket* -*query* -*milestone* \
		-*WikiMacros* -*RecentChanges*

##***********************************************************************************************##
## Ayuda
##***********************************************************************************************##
else
	ayuda $0
fi
 