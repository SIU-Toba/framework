#!/bin/bash
#
. i_config

#----------> La clave de este script es iterar por directorios y actuar ???

# Funcionalidad no implementada
#==> * Hacer funcionar todo

	dir=$toba_dir/var

##***********************************************************************************************##
## HOLA!
##***********************************************************************************************##

if [ "$1" = "hola" ]
then

	echo " objetivo: Script para generar los manuales del toba."

##***********************************************************************************************##
## Manejo de la documentacion automatica de codigo
##***********************************************************************************************##
#@ manual generar                              -- Genera el manual

elif [ "$1" = "generar" ]
then

	archivo_xsl=$toba_dir/var/docbook/XSL/fo/docbook.xsl;
	
	a=temp.xml 								#archivo original																		
	b=temp.fo								#archivo FO																		
	c=manual.pdf								#archivo PDF (final)																		
	
	echo 
	echo "Iniciando generador de Manual...."
	item /doc/docbook1 > $a
	
	echo
	echo "validando DTD...."
	xmllint --valid --noout --encode encoding $a
	controlar "VALIDACION DE XML_DOCBOOK"

	echo
	echo "transformando a XSL-FO...."
	xsltproc --stringparam fop.extensions 1 \
	--output $b \
	$archivo_xsl \
	$a
	controlar "TRANSFORMACION XML -> XSL-FO"
	
	echo
	echo "transformando a PDF...."
	fop.bat $b $c
	controlar "TRANSFORMACION XSL-FO -> PDF"
	rm -f $a
	rm -f $b
	controlar "Ficheros temporales eliminados"
	
	
	

##***********************************************************************************************##
## Ver Cosas Pendientes
##***********************************************************************************************##
elif [ "$1" = "pendiente" ]
then
	pendiente $0

##***********************************************************************************************##
## Ayuda
##***********************************************************************************************##
else
	ayuda $0
fi
