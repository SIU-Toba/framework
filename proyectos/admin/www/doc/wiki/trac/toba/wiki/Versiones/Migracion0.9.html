<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
 <title>Versiones/Migracion0.9.0 - SIU-Toba - Trac</title><link rel="start" href="../../wiki.html" /><link rel="search" href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" /><link rel="help" href="../TracGuide.html" /><link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="icon" href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/favicon.ico" type="image/x-icon" /><link rel="alternate" href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Versiones/Migracion0.9.0?format=txt" title="Plain Text" type="text/plain" /><style type="text/css">
.wikipage h2 {border-bottom: 1px solid gray;}
</style>
 <script type="text/javascript" src="../../chrome/common/js/trac.js"></script>
</head>
<body>


<div id="banner">

<div id="header"><a id="logo" href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba"><img src="../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a><hr /></div>

<form id="search" action="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" method="get">
 <div>
  <label for="proj-search">Search:</label>
  <input type="text" id="proj-search" name="q" size="10" accesskey="f" value="" />
  <input type="submit" value="Search" />
  <input type="hidden" name="wiki" value="on" />
  <input type="hidden" name="changeset" value="on" />
  <input type="hidden" name="ticket" value="on" />
 </div>
</form>



<div id="metanav" class="nav"><ul><li class="first"><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/login">Login</a></li><li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/settings">Settings</a></li><li><a href="../TracGuide.html" accesskey="6">Help/Guide</a></li><li class="last"><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/about" accesskey="9">About Trac</a></li></ul></div>
</div>

<div id="mainnav" class="nav"><ul><li class="active first"><a href="../../wiki.html" accesskey="1">Wiki</a></li><li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/timeline" accesskey="2">Timeline</a></li><li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/roadmap" accesskey="3">Roadmap</a></li><li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/browser">Browse Source</a></li><li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/report">View Tickets</a></li><li class="last"><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" accesskey="4">Search</a></li></ul></div>
<div id="main">




<div id="ctxtnav" class="nav">
 <h2>Wiki Navigation</h2>
 <ul>
  <li><a href="../../wiki.html">Start Page</a></li>
  <li><a href="../TitleIndex.html">Title Index</a></li>
  <li><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/RecentChanges">Recent Changes</a></li>
  
   <li class="last"><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Versiones/Migracion0.9.0?action=history">Page History</a></li>
  
 </ul>
 <hr />
</div>

<div id="content" class="wiki">

 
  
  
   <div class="wikipage">
    <div id="searchable"><p>
<a href="../WikiStart.html">Inicio</a> / <a href="../Versiones.html">Versiones</a> / Migracion0.9.0
</p>
<h1 id="InstructivodeMigraciónhacia0.9.0">Instructivo de Migración hacia 0.9.0</h1>
<h2 id="MigracióndeMETADATOS">Migración de METADATOS</h2>
<p>
La versión 0.9 implica un cambio radical en la forma en que los metadatos se almacenan en el sistema de archivos y por ende en los scripts administrativos que los manipulan. 
</p>
<h3 id="a1.Antesquenada">1. Antes que nada</h3>
<p>
Exportar los metadatos existentes y backupearlos en el SVN del proyecto. Esta es la ultima vez que se usan los comandos administrativos viejos.
</p>
<h3 id="a2.Checkout">2. Checkout</h3>
<p>
Hacer un checkout de la nueva versión de toba.
</p>
<h3 id="a3.MigrarlaInstalacióncompleta.">3. Migrar la Instalación completa.</h3>
<p>
En las versiones anteriores había una idea acoplada de lo que era la definición de las bases de datos disponibles con la definición de una instancia todo mezclado en el archivo <i>instancias.php</i>. Ahora la definición de las bases reside en el archivo <tt>$toba_dir/instalacion/bases.ini</tt> y la definición de la instancia X se encuentra en la carpeta <tt>$toba_dir/instalacion/i__X</tt>. Prueba de este acoplamiento es que no todas las definiciones del archivo instancias.php correspondían a instancias sino que también existían definiciones de bases de negocio. 
</p>
<p>
La migración se dispara con el comando
</p>
<pre class="wiki">toba instalacion migrar
</pre>
<p>
La primer pregunta se refiere al "ID del grupo de desarrollo", esto ayuda a que el trabajo de un grupo en un proyecto desarrollado en forma distribuida no afecte al trabajo de otro grupo, ver más en <a class="wiki" href="../Referencia/CelulaDesarrollo.html">Grupos de desarrollo</a>. La convención inicial que se puede tomar es que el grupo de Capital utilize el "1", Bahía el "2" y Tandil el "3".
Luego va a preguntar por cada definición existente si corresponde a un <i>instancia TOBA</i>o no, todas las definiciones irán a parar al archivo <tt>$toba_dir/instalacion/bases.ini</tt> y por cada respuesta afirmativa se creará una carpeta <tt>$toba_dir/instalacion/i__X</tt> con definiciones básicas dentro. 
</p>
<p>
Luego de esto se intenta migrar todas las instancias de la instalación y los proyecto contenidos dentro de esta instancia.
</p>
<p>
Una vez migradas las definiciones se puede ver el resultado con el comando
</p>
<pre class="wiki">toba instancia info
</pre>
<p>
Un paso opcional al finalizar la migración es borrar o renombrar el archivo obsoleto <i>$toba_dir/php/instancias.php</i>. Es una buena idea mirar el contenido creado en la carpeta <i>$toba_dir/instalacion</i> para entender la nueva disposición de archivos.
</p>
<h3 id="a4.Exportarlosproyectosconelnuevoformato">4. Exportar los proyectos con el nuevo formato</h3>
<p>
Los metadatos tienen que volver al sistema de archivos, pero esta vez al nuevo lugar <tt>$toba_dir/proyectos/mi_proyecto/metadatos</tt>
</p>
<pre class="wiki">toba exportar proyecto -p 'mi_proyecto'
</pre>
<p>
Repetir este paso para cada proyecto.
</p>
<h3 id="a5.Regenerartodalainstancia">5. Regenerar toda la instancia</h3>
<p>
Se necesita cargar el nuevo nucleo de toba y el nuevo administrador:
</p>
<pre class="wiki">toba instancia regenerar
</pre>
<h2 id="ModificacionesenlaAPI">Modificaciones en la API</h2>
<ul><li>La función ddrivetip está obsoleta y no se incluye por defecto, para utilizarla hacer un js::cargar_consumo_global(array('tooltips')), en su lugar se incluye una más potente (reescrita en base a una similar) llamada dhtml_tooltip.
</li><li>Desde el ci ya no se recomienda acceder más a las dependencias con $this-&gt;dependendencias[$id], sino con $this-&gt;dependencia($id), esto permite una carga 'a demanda' de un objeto.
</li><li>La clase "manejador_archivos" era el metodo viejo de hacer UPLOADs. La funcionalidad de esa clase se paso a "manejador_upload_archivos"
</li></ul><h2 id="NuevosRequisitos">Nuevos Requisitos</h2>
<ul><li>Se necesita tener el cliente de línea de comandos de SVN (svn.exe para windows) en el path del sistema. Esto es porque la nueva exportación cuando se borra algún componente necesita borrar el archivo de ese componente y por ende lo intenta borrar del repositorio también (desde ya queda a desición del desarrollador hacer un commit y subir el cambio).
</li></ul></div>
   </div>
   
  
  <script type="text/javascript">
   addHeadingLinks(document.getElementById("searchable"));
  </script>
 
 
</div>

<script type="text/javascript">searchHighlight()</script>
<div id="altlinks"><h3>Download in other formats:</h3><ul><li class="first last"><a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Versiones/Migracion0.9.0?format=txt">Plain Text</a></li></ul></div>

</div>

<div id="footer">
 <hr />
 <a id="tracpowered" href="../../../../external.html?link=http://trac.edgewall.com/"><img src="../../chrome/common/trac_logo_mini.png" height="30" width="107"
   alt="Trac Powered"/></a>
 <p class="left">
  Powered by <a href="../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/about"><strong>Trac 0.9.2</strong></a><br />
  By <a href="../../../../external.html?link=http://www.edgewall.com/">Edgewall Software</a>.
 </p>
 <p class="right">
  Creado por el Programa SIU<br /><a href="../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a>
 </p>
</div>



 </body>
</html>

