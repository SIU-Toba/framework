<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
 <title>Referencia/Deployment - SIU-Toba - Trac</title><link rel="start" href="../../wiki.html" /><link rel="search" href="../../../../external.html?link=https://localhost/trac/toba/search" /><link rel="help" href="../TracGuide.html" /><link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="icon" href="../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="alternate" href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Deployment?format=txt" title="Plain Text" type="text/plain" /><style type="text/css">
.wikipage h2 {border-bottom: 1px solid gray;}

/* trac php syntax highlighting */
.code-block {
    line-height: 1em;
    font-family: Courier, monotype;
    font-size: 12px;
    }
.h_question { color: #0000BB; } /* highlight.default */
.hphp_commentline { color: #FF8000; } /* highlight.comment */
.hphp_operator { color: #007700; } /* highlight.keyword */
.hphp_word { color: #007700; } /* highlight.keyword */
.hphp_default {}
.hphp_variable { color: #0000BB; } /* highlight.default */
.hphp_hstring { color: #DD0000; } /* highlight.string */
.hphp_simplestring { color: #DD0000; } /* highlight.string */
.h_tagunknown {}
.h_default {}

.code-keyword { color: #007700; font-weight: normal; }
.code-lang { color: #0000BB; font-weight: normal; }
.code-comment { color: #FF8000; font-weight: normal;}
.code-string { color: #DD0000; font-weight: normal;}
</style>
 <script type="text/javascript" src="../../chrome/common/js/trac.js"></script>
</head>

			<body>
			<table border='0' cellspacing='0' cellpadding='0' height='48' width='100%'>
			  <tr>
			
				<td class='header-top-left'><img src='../../../../../api/media/logo.png' border='0'/></td>
			    <td class='header-top-right'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../api/media/wiki.png' />
			    	<a href='../../../../../api/index.html'  title='Navegar hacia la documentación PHP'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../api/media/php-small.png' /></a> 
			    	<a href='../../../../../api_js/index.html'  title='Navegar hacia la documentación Javascript'>    		
			    	<img border='0' style='vertical-align: middle' src='../../../../../api/media/javascript-small.png' /></a>
			  </tr>
			
			  <tr>
			    <td colspan='2' class='header-menu'>
			  		  [ <a href='http://desarrollos2.siu.edu.ar/trac/toba/wiki/Referencia/Deployment' title='El sitio online contiene contenidos mas detallados y actualizados'
						class='menu'>Ver online</a> ]
			    </td>
			
			  </tr>
			  <tr><td colspan='2' class='header-line'><img src='../../../../../api/media/empty.png' width='1' height='1' border='0' alt=''  /></td></tr>
			</table>
		


<div id="banner">

<div id="header"><a id="logo" href="../../../../external.html?link=https://localhost/trac/toba"><img src="../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a><hr /></div>

<form id="search" action="../../../../external.html?link=https://localhost/trac/toba/search" method="get">
 
</form>



<div id="metanav" class="nav"><ul><li class="first"><a href="../../../../external.html?link=https://localhost/trac/toba/login">Login</a></li><li><a href="../../../../external.html?link=https://localhost/trac/toba/settings">Settings</a></li><li><a href="../TracGuide.html" accesskey="6">Help/Guide</a></li><li class="last"><a href="../../../../external.html?link=https://localhost/trac/toba/about">About Trac</a></li></ul></div>
</div>

<div id="mainnav" class="nav"><ul><li class="active first last"><a href="../../wiki.html" accesskey="1">Wiki</a></li></ul></div>
<div id="main">




<div id="ctxtnav" class="nav">
 <h2>Wiki Navigation</h2>
 <ul>
  <li><a href="../../wiki.html">Start Page</a></li>
  <li><a href="../TitleIndex.html">Title Index</a></li>
  <li><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/RecentChanges">Recent Changes</a></li>
  
   <li class="last"><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Deployment?action=history">Page History</a></li>
  
 </ul>
 <hr />
</div>

<div id="content" class="wiki">

 
  
  
   <div class="wikipage">
    <div id="searchable"><p>
<a href="../WikiStart.html">Inicio</a> / <a href="../Referencia.html">Referencia</a> / Deployment
</p>
<h1 id="DeploymentdeToba">Deployment de Toba</h1>
<p>
Los siguientes escenarios asumen la existencia de un control de versiones para el proyecto e instalaciones remotas.
</p>
<h2 id="MúltiplesInstalacionesdeTobaenunamismamáquina">Múltiples Instalaciones de Toba en una misma máquina</h2>
<p>
Para tener mútliples instalaciones de Toba en una misma máquina se deben tener en cuenta ciertas pautas adicionales a las básicas descriptas del proceso de <a class="wiki" href="../Instalacion.html">Instalación</a>.
</p>
<ul><li>En el include_path de PHP no debe estar incluído ninguna referencia a alguno de los toba instalados.
</li></ul><ul><li>Además de tener varias carpetas conteniendo las diferentes versiones de Toba, vamos a configurar igual cantidad de alias para los puntos de acceso, de modo que definan la variable de entorno $TOBA_DIR con la versión correcta de Toba. Tomemos como ejemplo el caso de dos instalaciones: una en el directorio <i>d:/toba_1</i>, la otra en <i>d:/toba_2</i>. La configuración de Apache debería contener los alias:
</li></ul><pre class="wiki">    Alias /toba_1 &#34;d:/toba_1/www&#34;
    &lt;Directory &#34;d:/toba_1/www/&#34;&gt;
        SetEnv TOBA_DIR d:/toba_1
        SetEnv TOBA_ALIAS toba_1
        Options Indexes MultiViews FollowSymLinks
		DirectoryIndex aplicacion.php
        AllowOverride None
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;

    Alias /toba_2 &#34;d:/toba_2/www&#34;
    &lt;Directory &#34;d:/toba_2/www/&#34;&gt;
        SetEnv TOBA_DIR D:/toba_2
        SetEnv TOBA_ALIAS toba_2
        Options Indexes MultiViews FollowSymLinks
		DirectoryIndex aplicacion.php
        AllowOverride None
        Order allow,deny
        Allow from all
    &lt;/Directory&gt;
</pre>
<p>
 
</p>
<ul><li>Para ejecutar scripts administrativos (del tipo instancia o proyecto, por ejemplo) vamos a necesitar previamente agregar al path la ubicación de los mismos, además de setear el valor de las variables de entorno $toba_dir y $toba_instancia. Si, por ejemplo, quisiéramos cargar la instancia de produccion de la instalación <i>toba_1</i>, los pasos a seguir para un entorno tipo linux serían los siguientes:
<pre class="wiki">export toba_dir=d:/toba_1
export toba_instancia=produccion
export PATH=$PATH:$toba_dir
toba instancia cargar
</pre>
</li></ul><p>
Una forma de evitar olvidos y errores seteando estas variables, es crear un comando por instalación que sea la puerta de entrada a la misma. Así no se utilizaría el comando 'toba' para las operaciones administrativas sino mas bien uno relacionado con la versión utilizada, por ejemplo 'toba_trunk' o 'toba_costos'. Por ejemplo usando bash, se podria crear el comando toba_trunk y ponerlo en /usr/bin:
</p>
<pre class="wiki">export toba_dir=/home/usuario/proyectos/toba
export toba_instancia=desarrollo
$toba_dir/bin/toba $*
</pre>
<p>
Y cada vez que se necesita ejecutar un comando de instalación se utiliza el comando 'toba_trunk' en lugar de 'toba'
</p>
<h2 id="PasajeDesarrolloProducción">Pasaje Desarrollo - Producción</h2>
<p>
El escenario más común es tener una única instancia de desarrollo y actualizar otra instancia (generalmente Producción o Testing) de manera periódica. Este escenario puede describirse en cinco pasos:
</p>
<p>
<a href="../../../../external.html?link=https://localhost/trac/toba/attachment/wiki/Referencia/Deployment/desarrollo_produccion.png" style="padding:0; border:none"><img src="../../attachment/wiki/Referencia/Deployment/desarrollo_produccion41f0.png?format=raw" /></a>
</p>
<ol><li><i>Desarrollo</i> - Exportación de metadatos: Siempre en desarrollo los últimos metadatos se encuentran en la base de datos (la instancia) y no en el sistema de archivos, esto es lógico porque los desarrolladores estubieron utilizando el Administrador en forma conjunta con esta instancia. La exportación se hace de la siguiente forma:
<pre class="wiki">toba proyecto exportar -p mi_proyecto
</pre>
</li><li><i>Desarrollo</i> - Commit de los nuevos archivos: El resultado de la exportación es la actualización de los archivos ubicados en la carpeta <i>metadatos</i> del proyecto. Junto a las modificaciones de código existentes se suben las modificaciones (commit) creando una nueva revisión, almacenada en un repositorio central.
</li><li><i>Produccion</i> - Actualización de la nueva revisión: Suponiendo que se toma la decisión de actualizar el sistema en producción el primer paso es actualizar el proyecto en cuestión, esto traera los metadatos y el código actualizado.
</li><li><i>Produccion</i> - Exportación de información local: Lo único que se necesita de la instancia en producción son sus usuarios, logs y demás metadatos considerados propios de la instancia, para el resto de los metadatos valen los de desarrollo. Entonces es necesario exportar los datos locales de esta instancia almacenandose en el sistema de archivos:
<pre class="wiki">toba instancia exportar_local
</pre>
</li><li><i>Produccion</i> - Regenerar el proyecto: Ahora que tanto los metadatos de desarrollo como los de los usuarios se encuentran en el sistema de archivos es posible regenerar el proyecto:
<pre class="wiki">toba proyecto regenerar -p mi_proyecto
</pre>
</li></ol><h2 id="ActualizacióndeToba">Actualización de Toba</h2>
<p>
Muchas veces es necesario actualizar la versión de toba con la que se está desarrollando (arreglo de bugs, nuevas funcionalidades deseadas, etc.), para esto hay que tener el cuidado de exportar los metadatos previo a la actualización, ya que actualizar toba muchas veces (no todas) implica reiniciar la instancia:
</p>
<p>
<a href="../../attachment/wiki/Referencia/Deployment/actualizacion_toba.html" style="padding:0; border:none"><img src="../../attachment/wiki/Referencia/Deployment/actualizacion_toba41f0.png?format=raw" /></a>
</p>
<ol><li>Exportar Metadatos del proyecto: Como los últimos metadatos se encuentran en la base de datos (la instancia) es necesario llevarlas al sistema de archivos y versionarlo. Así que para cada proyecto propio ubicado en esta instancia se debe hacer:
<pre class="wiki">toba proyecto exportar -p mi_proyecto
</pre>
</li><li>Exportación de información local: (YA NO ES NECESARIO: La exportación del proyecto actualmente también exporta la información local)
</li><li>Actualizar Toba: Se trae la nueva revisión de Toba desde el SVN.
</li><li>Actualización de metadatos: Es posible que la nueva versión requiera alguna migración automática (ver <a class="missing wiki" href="Versiones.html" rel="nofollow">Versiones Toba?</a>), para ello ejecutar:
<pre class="wiki">toba instalacion migrar
</pre>
</li></ol><p>
Por si la migración afecto algún metadato del proyecto es necesario volver a exportar al sistema de archivos:
</p>
<pre class="wiki">toba proyecto exportar -p mi_proyecto
</pre>
<p>
Con los nuevos metadatos de toba y los metadatos exportados del proyecto en el sistema de archivos es necesario volver a cargar la instancia:
</p>
<pre class="wiki">toba instancia regenerar
</pre>
<p>
Cabe notar que instancia regenerar como primer paso borra el contenido de la base, por lo que si la exportación no se efectuó o se efectuó con errores se perderán los datos del proyecto y sólo será posible recuperarlos desde alguna revisión del SVN del proyecto o algún backup manual.
</p>
<p>
Hay una razón por la cual la exportación se debe hacer antes que la actualización de código. Es posible que el nuevo código de toba haga referencia a nuevas columnas o nuevos campos no presentes en la instancia actual del proyecto (porque fue creada usando un toba más viejo). Si se quiere hacer la exportación luego de la actualización, este nuevo código va a querer exportar esta estructura de base de datos nueva no presente en la instancia actual, imposibilitando la extracción de los metadatos hacia el sistema de archivos. Hay una solución a este error, siempre y cuando no se haya ejecutado el tercer paso por la razón explicada en el párrafo anterior. La solución es volver atrás la revisión de toba a la misma con la que se generó la instancia y rearrancar el proceso.
</p>
</div>
   </div>
   
    <h3 id="tkt-changes-hdr">Attachments</h3>
    <ul class="tkt-chg-list"><li class="tkt-chg-change"><a href="../../../../external.html?link=https://localhost/trac/toba/attachment/wiki/Referencia/Deployment/desarrollo_produccion.png">desarrollo_produccion.png</a> (30.4 kB) - added by seba on 07/14/05 14:40:32.</li><li class="tkt-chg-change"><a href="../../attachment/wiki/Referencia/Deployment/actualizacion_toba.html">actualizacion_toba.png</a> (14.5 kB) - added by seba on 07/14/05 16:01:09.</li>
    </ul>
  
  
  <script type="text/javascript">
   addHeadingLinks(document.getElementById("searchable"));
  </script>
 
 
</div>

<script type="text/javascript">searchHighlight()</script>
<div id="altlinks"><h3>Download in other formats:</h3><ul><li class="first last"><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Deployment?format=txt">Plain Text</a></li></ul></div>

</div>

<div id="footer">
 <hr />
 <a id="tracpowered" href="../../../../external.html?link=http://trac.edgewall.com/"><img src="../../chrome/common/trac_logo_mini.png" height="30" width="107"
   alt="Trac Powered"/></a>
 <p class="left">
  Powered by <a href="../../../../external.html?link=https://localhost/trac/toba/about"><strong>Trac 0.9.5</strong></a><br />
  By <a href="../../../../external.html?link=http://www.edgewall.com/">Edgewall Software</a>.
 </p>
 <p class="right">
  Creado por el SIU<br /><a href="../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a>
 </p>
</div>



 </body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>

