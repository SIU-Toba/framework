<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
 <title>Referencia/MarcoTransaccional - SIU-Toba - Trac</title><link rel="start" href="../../wiki.html" /><link rel="search" href="../../../../external.html?link=https://localhost/trac/toba/search" /><link rel="help" href="../TracGuide.html" /><link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="icon" href="../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="alternate" href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/MarcoTransaccional?format=txt" title="Plain Text" type="text/x-trac-wiki" /><style type="text/css">
.wikipage h2 {border-bottom: 1px solid gray;}

/* trac php syntax highlighting */
.code-block {
    line-height: 1em;
    font-family: Courier, monotype;
    font-size: 12px;
    }
.h_question { color: #0000BB; } /* highlight.default */
.hphp_commentline { color: #FF8000; } /* highlight.comment */
.hphp_operator { color: #007700; } /* highlight.keyword */
.hphp_word { color: #007700; } /* highlight.keyword */
.hphp_default {}
.hphp_variable { color: #0000BB; } /* highlight.default */
.hphp_hstring { color: #DD0000; } /* highlight.string */
.hphp_simplestring { color: #DD0000; } /* highlight.string */
.h_tagunknown {}
.h_default {}

.code-keyword { color: #007700; font-weight: normal; }
.code-lang { color: #0000BB; font-weight: normal; }
.code-comment { color: #FF8000; font-weight: normal;}
.code-string { color: #DD0000; font-weight: normal;}

pre { padding:0; margin: 0}

.tablas-screenshots td:first-child { background-color: #D5CECD; width: 30%}
.tablas-screenshots table { width: 90%; border: 1px solid gray; }
.tablas-screenshots td { }
.tablas-screenshots table.wiki td { border: 1px solid gray; }

#tkt-changes-hdr {
    clear: both;
    padding-top: 30px;
}
.wiki-toc {
    clear: right;
    min-width: 160px;
    background-color:#F7F7F7;    
    border: 1px solid #D7D7D7;
}
.wiki-toc .active {
    background-color: #890C71;
    padding: 1px;
}
.wiki-toc .active a {
    color:white; 
}
.wiki-toc .active a:hover {
    background-color:  #890C71;
}
.indice-general {
/*    background-color: #FFFFDD;*/
}
.wikipage h1 {
    padding-top: 5px;
}
.wikipage h2 {
 padding: 2px;
}
.wikipage h1 {
    font-size: 28px;
}
.wikipage h2 {
    background-color: #890C71;
    color: white;
    padding-left: 10px;
    margin-top: 30px;
    font-size: 100%;
    border: 1px solid gray;
}
.wikipage h3 {
    font-size:100%;
}
li {
    margin-bottom:4px;
}
li * {
    margin-bottom:0;
}
/*a {
 color: #890C71;
}*/
@media print {
 .wiki-toc { display: none }
}
#tkt-changes-hdr, .tkt-chg-list { 
    font-size:80%;
    text-align:right;
}

</style>
 <script type="text/javascript" src="../../chrome/common/js/trac.js"></script>
</head>

			<body>
			<table border='0' cellspacing='0' cellpadding='0' height='48' width='100%'>
			  <tr>
			
				<td class='header-top-left'><img src='../../../../../api/media/logo.png' border='0'/></td>
			    <td class='header-top-right'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../api/media/wiki.png' />
			    	<a href='../../../../../api/index.html'  title='Navegar hacia la documentación PHP'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../api/media/php-small.png' /></a> 
			    	<a href='../../../../../api_js/index.html'  title='Navegar hacia la documentación Javascript'>    		
			    	<img border='0' style='vertical-align: middle' src='../../../../../api/media/javascript-small.png' /></a>
			  </tr>
			
			  <tr>
			    <td colspan='2' class='header-menu'>
			  		  [ <a href='http://desarrollos.siu.edu.ar/trac/toba/wiki/Referencia/MarcoTransaccional' title='El sitio online contiene contenidos mas detallados y actualizados'
						class='menu'>Ver online</a> ]
			    </td>
			
			  </tr>
			  <tr><td colspan='2' class='header-line'><img src='../../../../../api/media/empty.png' width='1' height='1' border='0' alt=''  /></td></tr>
			</table>
		


<div id="banner">

<div id="header"><a id="logo" href="../../../../external.html?link=https://localhost/trac/toba"><img src="../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a><hr /></div>

<form id="search" action="../../../../external.html?link=https://localhost/trac/toba/search" method="get">
 <div>
  <label for="proj-search">Search:</label>
  <input type="text" id="proj-search" name="q" size="10" accesskey="f" value="" />
  <input type="submit" value="Search" />
  <input type="hidden" name="wiki" value="on" />
  <input type="hidden" name="changeset" value="on" />
  <input type="hidden" name="ticket" value="on" />
 </div>
</form>



<div id="metanav" class="nav"><ul><li class="first"><a href="../../../../external.html?link=https://localhost/trac/toba/login">Login</a></li><li><a href="../../../../external.html?link=https://localhost/trac/toba/settings">Settings</a></li><li><a accesskey="6" href="../TracGuide.html">Help/Guide</a></li><li class="last"><a href="../../../../external.html?link=https://localhost/trac/toba/about">About Trac</a></li></ul></div>
</div>

<div id="mainnav" class="nav"><ul><li class="active first"><a accesskey="1" href="../../wiki.html">Wiki</a></li><li><a accesskey="2" href="../../../../external.html?link=https://localhost/trac/toba/timeline">Timeline</a></li><li><a href="../../../../external.html?link=https://localhost/trac/toba/browser">Browse Source</a></li><li class="last"><a accesskey="4" href="../../../../external.html?link=https://localhost/trac/toba/search">Search</a></li></ul></div>
<div id="main">




<div id="ctxtnav" class="nav">
 <h2>Wiki Navigation</h2>
 <ul>
   <li><a href="../../wiki.html">Start Page</a></li>
   <li><a href="../TitleIndex.html">Index by Title</a></li>
   <li><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/RecentChanges">Index by Date</a></li>
   <li class="last"><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/MarcoTransaccional?action=diff&amp;version=24">Last Change</a></li>
 </ul>
 <hr />
</div>

<div id="content" class="wiki">

 
  
  
   
   <div class="wikipage">
    <div id="searchable"><h1 id="MarcoTransaccional">Marco Transaccional</h1>
<p>
Una operación se puede pensar como una transición entre dos estados. Entre estos dos estados existen estados intermedios, internos a la construcción, del cual no se toma conocimiento hasta que la entidad es finalmente construida. La función de la aplicación es guiar al usuario en esta construcción, con suficiente información acerca del estado actual, restringiendo los caminos hacia inconsistencias pero flexibilizando para no entorpecer la capacidad constructiva. Esta construcción toma la forma de una <strong>transacción de negocio</strong>.
</p>
<h2 id="Requisitos">Requisitos</h2>
<p>
Una transacción de negocio tiene impuesta generalmente distintos requisitos: los efectos de la misma no serán conocidos en forma parcial (<strong>atomicidad</strong>), ni rompen las reglas preestablecidas (<strong>consistencia</strong>), su desarrollo se basa sobre datos certeros y su resultado no es conocido hasta su finalización (<strong>aislamiento</strong>), finalmente estos resultados perduran en el tiempo (<strong>durabilidad</strong>). Estos requisitos se conocen como <i>ACID</i> en base a las siglas de cada uno.<br />
</p>
<p>
Las bases de datos relacionales, en mayor o menor medida, poseen mecanismos para garantizar estos requisitos simplemente incluyendo la operación dentro de una <i>transacción de base de datos</i>. Hay algunos problemas con esta solución, el primero es la llamada disponibilidad de los datos. Para asegurar la consistencia en general se utilizan bloqueos pesimistas, previniendo que los recursos sean utilizados por otros mientras la transacción está en curso, en una aplicación Web una transacción de negocios puede durar varios minutos, incluso por su naturaleza desconectada, varias horas. Bloquear <i>registros</i> por horas puede traer problemas graves de concurrencia, dejando ramas de operaciones inaplicables por causa del bloqueo. Es por esto que se construyen técnicas a un nivel superior utilizando los llamados <i>bloqueos optimistas</i>, relegando los bloqueos a nivel de base de datos hasta el final de la transacción de negocio y sólo aplicando restricciones a los datos que tienen valor real de negocio. Por ejemplo en los carritos de compras de ventas online, si hay disponible una única unidad de un producto no se previene que dos usuarios lo agreguen simultáneamente a su carrito, dejan los controles hasta el final de la transacción cuando el usuario confirma la adquisición, de lo contrario se pierde un potencial cliente en base a una suposición incorrecta (un alto porcentaje no hace un checkout de la elección).
</p>
<p>
Aún cuando los motores brinden capacidad de bloqueos optimistas, desde el lenguaje de programación (en este caso PHP) se debería mantener abierta una conexión con la base por cada sesión en curso (si cerrara la conexión cuando termina el pedido de página automáticamente se abortaría la transacción). Esto actualmente no es técnicamente posible, y si lo fuera sería tremendamente ineficiente para un sistema con mucha carga.
</p>
<h2 id="Operación">Operación</h2>
<p>
Una operación definida en toba traspasa por tres estados principales: un inicio, un desarrollo y un procesamiento final. El progreso se da a manera de turnos entre el lado cliente y el servidor, representados por el navegador y PHP respectivamente. Dentro de una operación existen datos transaccionales y otros ordinarios, que no requieren las calidades vistas anteriormente. Estos datos ordinarios serán consultados en cada pedido de página, mientras que los transaccionales serán consultados al inicio de la operación, modificados durante el desarrollo (en forma de variables de sesión) y finalmente sincronizados con la fuente de datos al final de la operación a través de una transacción de base de datos.
</p>
<p>
<a style="padding:0; border:none" href="../../attachment/wiki/Referencia/MarcoTransaccional/estados.html"><img src="../../attachment/wiki/Referencia/MarcoTransaccional/estados41f0.png?format=raw" /></a>
</p>
<h2 id="Pedidodepágina">Pedido de página</h2>
<p>
El control general de un pedido de página está a cargo de los <strong><a class="wiki" href="Objetos/ci.html">Controladores de interface</a></strong>. Al inicio del pedido se restaura el estado del CI, este estado se persiste entre pedidos utilizando las variables de sesión de PHP, garantizando el <strong>aislamiento</strong> entre las distintas operaciones en ejecución. Por otro lado, desde los elementos de interface (<a class="wiki" href="Objetos.html">ei</a>) se reciben los <strong><a class="wiki" href="Eventos.html">eventos</a></strong> (datos proporcionados por el usuario). Estos eventos se <i>escuchan</i> en código recibiendo los datos como parámetro, allí es cuando se realizan chequeos y se cambia el estado interno de la operación. Hay operaciones que por su complejidad requieren un número importante de <a class="wiki" href="Objetos/ci.html">Controladores de interface</a>, entonces lo que se hace es centralizar la información en un <strong><a class="wiki" href="Objetos/cn.html">Controladores de negocio</a></strong>.
</p>
<p>
<a style="padding:0; border:none" href="../../attachment/wiki/Referencia/MarcoTransaccional/pedido.html"><img src="../../attachment/wiki/Referencia/MarcoTransaccional/pedido41f0.png?format=raw" /></a>
</p>
<p>
Luego del procesamiento de eventos provenientes del pedido anterior, el ítem se prepara para brindar el <a class="wiki" href="Solicitud.html#Tiposdeservicio">servicio</a> requerido, generalmente lanzando la construcción de la salida HTML. Finalmente el estado de CIs,CNs y componentes de persistencia vuelve a almacenarse en variables de sesión, listo para continuar el ciclo.
</p>
<p>
Cuando la información que se maneja en esta <i>transacción de negocios</i> es un conjunto de datos tabulares cuya carga y sincronización es con una base de datos relacional existen una serie de componentes que facilitan:
</p>
<ul><li>La carga de los datos.
</li><li>El trabajo dentro de la transacción.
</li><li>La sincronización con el medio de persistencia.
</li></ul><p>
Se los conoce como <a class="wiki" href="Objetos/Persistencia.html">Componentes de Persistencia</a>
</p>
<p>
El ciclo finaliza con un evento (generalmente nombrado como <i>procesar</i>) localizado en el CI de la operación. Este evento es el encargado de sincronizar con la fuente de datos utilizando una transacción de base de datos que garantiza la <strong>atomicidad</strong> y <strong>durabilidad</strong> de la operación. Este evento es un lugar adecuado para realizar los controles finales sobre los datos obtenidos, garantizando así la <strong>consistencia</strong> de los mismos.
</p>
<h2 id="Ejemplo">Ejemplo</h2>
<p>
Por ejemplo si se tratara de una operación que recolectara direcciones de mail para posteriormente mostrando una grilla con las direcciones para ser enviadas, el gráfico anterior estaría instanciado de la siguiente manera:
</p>
<p>
<a style="padding:0; border:none" href="../../attachment/wiki/Referencia/MarcoTransaccional/ejemplo_pedido.html"><img src="../../attachment/wiki/Referencia/MarcoTransaccional/ejemplo_pedido41f0.png?format=raw" /></a>
</p>
</div>
   </div>
   
    <h3 id="tkt-changes-hdr">Attachments</h3>
    <ul class="tkt-chg-list"><li class="tkt-chg-change"><a href="../../attachment/wiki/Referencia/MarcoTransaccional/estados.html">estados.png</a> (3.2 kB) - added by seba on 11/02/06 16:45:26.</li><li class="tkt-chg-change"><a href="../../attachment/wiki/Referencia/MarcoTransaccional/pedido.html">pedido.png</a> (4.8 kB) - added by seba on 11/02/06 17:51:44.</li><li class="tkt-chg-change"><a href="../../attachment/wiki/Referencia/MarcoTransaccional/ejemplo_pedido.html">ejemplo_pedido.png</a> (5.3 kB) - added by seba on 11/02/06 18:12:50.</li>
    </ul>
  
  
  <script type="text/javascript">
   addHeadingLinks(document.getElementById("searchable"), "Link to this section");
  </script>
 
 
</div>

<script type="text/javascript">searchHighlight()</script>
<div id="altlinks"><h3>Download in other formats:</h3><ul><li class="first last"><a href="../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/MarcoTransaccional?format=txt">Plain Text</a></li></ul></div>

</div>

<div id="footer">
 <hr />
 <a id="tracpowered" href="../../../../external.html?link=http://trac.edgewall.org/"><img src="../../chrome/common/trac_logo_mini.png" height="30" width="107"
   alt="Trac Powered"/></a>
 <p class="left">
  Powered by <a href="../../../../external.html?link=https://localhost/trac/toba/about"><strong>Trac 0.10.3</strong></a><br />
  By <a href="../../../../external.html?link=http://www.edgewall.org/">Edgewall Software</a>.
 </p>
 <p class="right">
  Creado por el SIU<br /><a href="../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a>
 </p>
</div>



 </body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>

