<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
 <title>Referencia/Objetos/Persistencia - SIU-Toba - Trac</title><link rel="start" href="../../../wiki.html" /><link rel="search" href="../../../../../external.html?link=https://localhost/trac/toba/search" /><link rel="help" href="../../TracGuide.html" /><link rel="stylesheet" href="../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/common/css/wiki.css" type="text/css" /><link rel="icon" href="../../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="../../../../../external.html?link=https://localhost/favicon.ico" type="image/x-icon" /><link rel="alternate" href="../../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Objetos/Persistencia?format=txt" title="Plain Text" type="text/plain" /><style type="text/css">
.wikipage h2 {border-bottom: 1px solid gray;}

/* trac php syntax highlighting */
.code-block {
    line-height: 1em;
    font-family: Courier, monotype;
    font-size: 12px;
    }
.h_question { color: #0000BB; } /* highlight.default */
.hphp_commentline { color: #FF8000; } /* highlight.comment */
.hphp_operator { color: #007700; } /* highlight.keyword */
.hphp_word { color: #007700; } /* highlight.keyword */
.hphp_default {}
.hphp_variable { color: #0000BB; } /* highlight.default */
.hphp_hstring { color: #DD0000; } /* highlight.string */
.hphp_simplestring { color: #DD0000; } /* highlight.string */
.h_tagunknown {}
.h_default {}

.code-keyword { color: #007700; font-weight: normal; }
.code-lang { color: #0000BB; font-weight: normal; }
.code-comment { color: #FF8000; font-weight: normal;}
.code-string { color: #DD0000; font-weight: normal;}

pre { padding:0; margin: 0}

.tablas-screenshots td:first-child { background-color: #D5CECD; width: 30%}
.tablas-screenshots table { width: 90%; border: 1px solid gray; }
.tablas-screenshots td { }
.tablas-screenshots table.wiki td { border: 1px solid gray; }

#tkt-changes-hdr {
    clear: both;
    padding-top: 30px;
}
.wiki-toc {
    clear: right;
    min-width: 160px;
    background-color:#F7F7F7;    
    border: 1px solid #D7D7D7;
}
.wiki-toc .active {
    background-color: #890C71;
    padding: 1px;
}
.wiki-toc .active a {
    color:white; 
}
.wiki-toc .active a:hover {
    background-color:  #890C71;
}
.indice-general {
/*    background-color: #FFFFDD;*/
}
.wikipage h1 {
    padding-top: 5px;
}
.wikipage h2 {
 padding: 2px;
}
.wikipage h1 {
    font-size: 28px;
}
.wikipage h2 {
    background-color: #890C71;
    color: white;
    padding-left: 10px;
    margin-top: 30px;
    font-size: 100%;
    border: 1px solid gray;
}
.wikipage h3 {
    font-size:100%;
}
li {
    margin-bottom:4px;
}
li * {
    margin-bottom:0;
}
/*a {
 color: #890C71;
}*/
@media print {
 .wiki-toc { display: none }
}
#tkt-changes-hdr, .tkt-chg-list { 
    font-size:80%;
    text-align:right;
}

</style>
 <script type="text/javascript" src="../../../chrome/common/js/trac.js"></script>
</head>

			<body>
			<table border='0' cellspacing='0' cellpadding='0' height='48' width='100%'>
			  <tr>
			
				<td class='header-top-left'><img src='../../../../../../api/media/logo.png' border='0'/></td>
			    <td class='header-top-right'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../../api/media/wiki.png' />
			    	<a href='../../../../../../api/index.html'  title='Navegar hacia la documentación PHP'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../../api/media/php-small.png' /></a> 
			    	<a href='../../../../../../api_js/index.html'  title='Navegar hacia la documentación Javascript'>    		
			    	<img border='0' style='vertical-align: middle' src='../../../../../../api/media/javascript-small.png' /></a>
			  </tr>
			
			  <tr>
			    <td colspan='2' class='header-menu'>
			  		  [ <a href='http://desarrollos2.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia' title='El sitio online contiene contenidos mas detallados y actualizados'
						class='menu'>Ver online</a> ]
			    </td>
			
			  </tr>
			  <tr><td colspan='2' class='header-line'><img src='../../../../../../api/media/empty.png' width='1' height='1' border='0' alt=''  /></td></tr>
			</table>
		


<div id="banner">

<div id="header"><a id="logo" href="../../../../../external.html?link=https://localhost/trac/toba"><img src="../../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a><hr /></div>

<form id="search" action="../../../../../external.html?link=https://localhost/trac/toba/search" method="get">
 <div>
  <label for="proj-search">Search:</label>
  <input type="text" id="proj-search" name="q" size="10" accesskey="f" value="" />
  <input type="submit" value="Search" />
  <input type="hidden" name="wiki" value="on" />
  <input type="hidden" name="changeset" value="on" />
  <input type="hidden" name="ticket" value="on" />
 </div>
</form>



<div id="metanav" class="nav"><ul><li class="first"><a href="../../../../../external.html?link=https://localhost/trac/toba/login">Login</a></li><li><a href="../../../../../external.html?link=https://localhost/trac/toba/settings">Settings</a></li><li><a href="../../TracGuide.html" accesskey="6">Help/Guide</a></li><li class="last"><a href="../../../../../external.html?link=https://localhost/trac/toba/about">About Trac</a></li></ul></div>
</div>

<div id="mainnav" class="nav"><ul><li class="active first"><a href="../../../wiki.html" accesskey="1">Wiki</a></li><li><a href="../../../../../external.html?link=https://localhost/trac/toba/timeline" accesskey="2">Timeline</a></li><li><a href="../../../../../external.html?link=https://localhost/trac/toba/browser">Browse Source</a></li><li class="last"><a href="../../../../../external.html?link=https://localhost/trac/toba/search" accesskey="4">Search</a></li></ul></div>
<div id="main">




<div id="ctxtnav" class="nav">
 <h2>Wiki Navigation</h2>
 <ul>
  <li><a href="../../../wiki.html">Start Page</a></li>
  <li><a href="../../TitleIndex.html">Title Index</a></li>
  <li><a href="../../../../../external.html?link=https://localhost/trac/toba/wiki/RecentChanges">Recent Changes</a></li>
  
   <li class="last"><a href="../../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Objetos/Persistencia?action=history">Page History</a></li>
  
 </ul>
 <hr />
</div>

<div id="content" class="wiki">

 
  
  
   <div class="wikipage">
    <div id="searchable"><p>
<div class="wiki-toc indice-general"><h4>Indice General</h4><ul><li><a href="../../Instalacion.html">Instalación</a></li><li><a href="../../Referencia.html">Conceptos Básicos</a></li><li><a href="../Objetos.html">Componentes</a></li><li><a href="../Eventos.html">Eventos</a></li><li><a href="../FuenteDatos.html">Fuentes de Datos</a></li><li class="active"><a href="Persistencia.html">Persistencia</a></li><li><a href="../../Tutorial.html">Tutorial</a></li><li><a href="../../Proyectos/Referencia.html">Proyecto Referencia</a></li><li><a href="../../../../../external.html?link=https://localhost/toba_editor_trunk/doc/api/index.html"><img src="../../../../../toba_editor_trunk/doc/api/media/php-small.png" style="vertical-align: middle"/> API PHP</a><li><a href="../../../../../external.html?link=https://localhost/toba_editor_trunk/doc/api_js/index.html"><img src="../../../../../toba_editor_trunk/doc/api/media/javascript-small.png" style="vertical-align: middle"/> API Javascript</a></ul></div>
<div class="wiki-toc"><h4>En esta página</h4><ol><li><a href="#Beneficios">Beneficios</a></li><li>
<a href="#ComportamientoGeneral">Comportamiento General</a><ol><li><a href="#Duranteladefinición">Durante la definición</a></li><li>
<a href="#Durantelaejecución">Durante la ejecución</a></li></ol></li></ol></li></ol></div>
<a href="../../WikiStart.html">Inicio</a> / <a href="../../Referencia.html">Referencia</a> / <a href="../Objetos.html">Objetos</a> / Persistencia
</p>
<h1 id="Introducciónaloscomponentesdepersistencia">Introducción a los componentes de persistencia</h1>
<p>
Los componentes de persistencia brindan tres servicios a la aplicación: 
</p>
<ul><li>Cargar un conjunto de datos relacionados
</li><li>Mantener en memoria los <i>cambios</i> realizados por el usuario a estos datos 
</li><li>Finalmente sincronizarlos con el medio de persistencia cuando sea solicitado.
</li></ul><p>
Estos servicios ayudan al <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/multi_etapa.gif' /> <a class="wiki" href="ci.html">controlador de interface</a> a garantizar del <a class="wiki" href="../MarcoTransaccional.html">Marco Transaccional</a> de una operación.
</p>
<h2 id="Beneficios">Beneficios</h2>
<p>
Cuando los datos a manejar son simples, es fácil mantener entre pedidos de página la información en la sesión en forma plana, en toba esto lo hace generalmente el CI. Cuando los datos empiezan a ser complejos, fruto del manejo de relaciones en la base de datos, es difícil que mantener estas estructuras en forma manual.
</p>
<p>
La solución a este problema es describir en forma de componentes a las <strong>tablas</strong> y <strong>relaciones</strong> que se van a manipular en la transacción. 
</p>
<p>
La solución que brindan estos componentes son:
</p>
<ul><li>Guardar el estado de los datos que se manejan en la operación. El ci sólo tendrá que guardar en sesión información relacionada con la presentación pero ya no más los datos de la operación.
</li><li>Brindar una API de manipulación de datos orientada a datos tabulares.
</li><li>Brindar un mecanismo de carga y sincronización. Para mantener independencia con el medio, este proceso es guiado por una clase separada llamada <a class="wiki" href="AP.html">Administrador de persistencia</a>, es la que en definitiva forma las query de carga y los comandos update, insert y delete para el caso de una base de datos relacional.
</li></ul><p>
 
</p>
<h2 id="ComportamientoGeneral">Comportamiento General</h2>
<h3 id="Duranteladefinición">Durante la definición</h3>
<ul><li>Se modelan datos tabulares, generalmente tablas de una base relacional. El componente utilizado es el <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/datos_tabla.gif' /> <a class="wiki" href="datos_tabla.html">datos_tabla</a>.
</li><li>Se modelan las relaciones entre estas tabla (utilizando el componente <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/datos_relacion.gif' /> <a class="wiki" href="datos_relacion.html">datos_relacion</a>).
</li><li>Se asigna la relación al <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/multi_etapa.gif' /> <a class="wiki" href="ci.html">CI</a> encargado de la transacción.
</li></ul><p>
<a href="../../../attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.html" style="padding:0; border:none"><img src="../../../attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia41f0.png?format=raw" /></a>
</p>
<h3 id="Durantelaejecución">Durante la ejecución</h3>
<p>
Siempre desde el CI encargado de la transacción:
</p>
<ul><li>Se <strong>cargan datos</strong> en la relación con una restricción (generalmente la clave de la tabla principal que se está editando), en caso del alta de un nuevo registro se resetea la relación (por si estaba cargada con algún dato previamente). 
<div class="code"><pre><span class="code-lang">&lt;?php
    </span><span class="code-keyword">function </span><span class="code-lang">evt__cuadro_personas__seleccion</span><span class="code-keyword">(</span><span class="code-lang">$id</span><span class="code-keyword">)
    {
        </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">dep</span><span class="code-keyword">(</span><span class="code-string">'datos'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">cargar</span><span class="code-keyword">(</span><span class="code-lang">$id</span><span class="code-keyword">);
        </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">set_pantalla</span><span class="code-keyword">(</span><span class="code-string">'edicion'</span><span class="code-keyword">);
    }
</span><span class="code-lang">?&gt;
</span></span>
</pre></div></li></ul><ul><li>Los eventos de los distintos elementos de interface (eis) son ruteados hacia el datos_tabla correspondiente. Por ejemplo en la configuración de un formulario se alimenta del datos_tabla que contiene los datos que se quieren manipular, lo mismo sucede cuando se produce la modificación. El siguiente ejemplo <strong>trabaja con un solo registro</strong> por eso la simplicidad de la llamada:
<div class="code"><pre><span class="code-lang">&lt;?php
    </span><span class="code-keyword">function </span><span class="code-lang">conf__formulario</span><span class="code-keyword">()
    {
        return </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">dep</span><span class="code-keyword">(</span><span class="code-string">'datos'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">tabla</span><span class="code-keyword">(</span><span class="code-string">'personas'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">get</span><span class="code-keyword">();
    }
    
    function </span><span class="code-lang">evt__formulario__modificacion</span><span class="code-keyword">(</span><span class="code-lang">$datos</span><span class="code-keyword">)
    {
        </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">dep</span><span class="code-keyword">(</span><span class="code-string">'datos'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">tabla</span><span class="code-keyword">(</span><span class="code-string">'personas'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">set</span><span class="code-keyword">(</span><span class="code-lang">$datos</span><span class="code-keyword">);
    }
</span><span class="code-lang">?&gt;
</span></span>
</pre></div></li></ul><ul><li>Cuando el CI quiere finalizar la transacción (por ejemplo el usuario decide <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/guardar.gif' /> guardar), se pide <strong>sincronizar</strong> el datos_relacion. En este caso se elige volver a la pantalla de selección luego de la sincronización.
<div class="code"><pre><span class="code-lang">&lt;?php
    </span><span class="code-keyword">function </span><span class="code-lang">evt__procesar</span><span class="code-keyword">()
    {
        </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">dep</span><span class="code-keyword">(</span><span class="code-string">'datos'</span><span class="code-keyword">)-&gt;</span><span class="code-lang">sincronizar</span><span class="code-keyword">();
        </span><span class="code-lang">$this</span><span class="code-keyword">-&gt;</span><span class="code-lang">set_pantalla</span><span class="code-keyword">(</span><span class="code-string">'seleccion'</span><span class="code-keyword">);
    }

</span><span class="code-lang">?&gt;
</span></span>
</pre></div></li></ul><p>
Estos son los pasos para escenarios sencillos, para más información sobre los servicios que brindan estos componentes se encuentra en:
</p>
<ul><li><img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/datos_relacion.gif' /> <a class="wiki" href="datos_relacion.html">datos_relacion</a>
</li><li><img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_trunk/img/objetos/datos_tabla.gif' /> <a class="wiki" href="datos_tabla.html">datos_tabla</a>
</li></ul><p>
Ver el funcionamiento de las clases de persistencia con un <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../toba_editor_trunk/img/referencia.png' /> <strong><a href='../../../../../external.html?link=https://localhost/toba_referencia_trunk/aplicacion.php?ai=toba_referencia||2658' title='Navega hacia el ejemplo en el proyecto online de referencia'>Ejemplo de operación</a></strong>
</p>
</div>
   </div>
   
    <h3 id="tkt-changes-hdr">Attachments</h3>
    <ul class="tkt-chg-list"><li class="tkt-chg-change"><a href="../../../attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.html">intro_persistencia.png</a> (9.9 kB) - added by seba on 10/12/06 11:31:13.</li>
    </ul>
  
  
  <script type="text/javascript">
   addHeadingLinks(document.getElementById("searchable"));
  </script>
 
 
</div>

<script type="text/javascript">searchHighlight()</script>
<div id="altlinks"><h3>Download in other formats:</h3><ul><li class="first last"><a href="../../../../../external.html?link=https://localhost/trac/toba/wiki/Referencia/Objetos/Persistencia?format=txt">Plain Text</a></li></ul></div>

</div>

<div id="footer">
 <hr />
 <a id="tracpowered" href="../../../../../external.html?link=http://trac.edgewall.com/"><img src="../../../chrome/common/trac_logo_mini.png" height="30" width="107"
   alt="Trac Powered"/></a>
 <p class="left">
  Powered by <a href="../../../../../external.html?link=https://localhost/trac/toba/about"><strong>Trac 0.9.5</strong></a><br />
  By <a href="../../../../../external.html?link=http://www.edgewall.com/">Edgewall Software</a>.
 </p>
 <p class="right">
  Creado por el SIU<br /><a href="../../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a>
 </p>
</div>



 </body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>

