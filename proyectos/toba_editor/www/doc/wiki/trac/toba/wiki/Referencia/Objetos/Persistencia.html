<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="../../../../../external.html?link=http://www.w3.org/1999/xhtml">
  
  

  


  

  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
    <title>
      Referencia/Objetos/Persistencia – SIU-Toba
    </title>
        <link rel="search" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/search" />
        <link rel="help" href="../../TracGuide.html" />
        <link rel="alternate" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="up" href="../Objetos.html" title="View parent page" />
        <link rel="start" href="../../../wiki.html" />
        <link rel="stylesheet" href="../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/common/css/wiki.css" type="text/css" />
        <link rel="shortcut icon" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/search/opensearch" title="Search SIU-Toba" />
    <script type="text/javascript" src="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/chrome/common/js/jquery.js"></script><script type="text/javascript" src="../../../chrome/common/js/trac.js"></script><script type="text/javascript" src="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/chrome/common/js/search.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/toba/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
      });
    </script>
    <script type="text/javascript" src="../../../chrome/site/mootools.js"></script>
    <script type="text/javascript" src="../../../chrome/site/slimbox.js"></script>
    <link rel="stylesheet" href="../../../chrome/site/portada.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../../../chrome/site/slimbox.css" type="text/css" media="screen" />
    <a style="position: absolute; top: 5px; left:5px;border-bottom:none !important;" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba"><img src="../../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a>
    <link rel="stylesheet" type="text/css" href="../../../chrome/site/style.css" />
  </head>
  
			<body>
			<table border='0' cellspacing='0' cellpadding='0' height='48' width='100%'>
			  <tr>
			
				<td class='header-top-left'><img src='../../../../../../api/media/logo.png' border='0'/></td>
			    <td class='header-top-right'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../../api/media/wiki.png' />
			    	<a href='../../../../../../api/index.html'  title='Navegar hacia la documentación PHP'>
			    		<img border='0' style='vertical-align: middle' src='../../../../../../api/media/php-small.png' /></a> 
			    	<a href='../../../../../../api_js/index.html'  title='Navegar hacia la documentación Javascript'>    		
			    	<img border='0' style='vertical-align: middle' src='../../../../../../api/media/javascript-small.png' /></a>
			  </tr>
			
			  <tr>
			    <td colspan='2' class='header-menu'>
			  		  [ <a href='http://repositorio.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia' title='El sitio online contiene contenidos mas detallados y actualizados'
						class='menu'>Ver online</a> ]
			    </td>
			
			  </tr>
			  <tr><td colspan='2' class='header-line'><img src='../../../../../../api/media/empty.png' width='1' height='1' border='0' alt=''  /></td></tr>
			</table>
		
<a style="position: absolute; top: 5px; left:5px;border-bottom:none !important;" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba"><img src="../../../chrome/site/logo_toba_siu_original.gif" width="282" height="90" alt="SIU-Toba" /></a>
    <div id="siteheader">
    </div>
    <div id="banner">
      <div id="header">
        <a id="logo" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba"><img src="../../../chrome/site/logo_toba_siu.gif" alt="Toba" height="90" width="282" /></a>
      </div>
      <form id="search" action="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/login">Login</a></li><li><a href="../../TracGuide.html">Help/Guide</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/about">About Trac</a></li><li class="last"><a href="../../../prefs.html">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="../../../wiki.html">Wiki</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/timeline">Timeline</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/roadmap">Roadmap</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/browser">Browse Source</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/query">View Tickets</a></li><li class="last"><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/search">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
              <li class="first"><a href="../Objetos.html">Up</a></li><li><a href="../../WikiStart.html">Start Page</a> / <a href="../../Referencia.html">Referencia</a> / <a href="../Objetos.html">Objetos</a> / Persistencia</li><li><a href="../../TitleIndex.html">Index</a></li><li><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia?action=history">History</a></li><li class="last"><a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia?action=diff&amp;version=35">Last Change</a></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <p class="path noprint">
        <a class="pathentry" title="View Referencia" href="../../Referencia.html">Referencia</a><span class="pathentry sep">/</span><a class="pathentry" title="View Referencia/Objetos" href="../Objetos.html">Objetos</a><span class="pathentry sep">/</span><a class="pathentry" title="View Referencia/Objetos/Persistencia" href="Persistencia.html">Persistencia</a>
        <br style="clear: both" />
      </p>
      <div class="wikipage searchable">
        
          <h1 id="Introducciónaloscomponentesdepersistencia">Introducción a los componentes de persistencia</h1>
<p>
Los componentes de persistencia brindan tres servicios a la aplicación: 
</p>
<ul><li>Cargar un conjunto de datos relacionados
</li><li>Mantener en memoria los <i>cambios</i> realizados por el usuario a estos datos 
</li><li>Finalmente sincronizarlos con el medio de persistencia cuando sea solicitado.
</li></ul><p>
Estos servicios ayudan al <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/multi_etapa.gif' /> <a class="wiki" href="ci.html">controlador de interface</a> a garantizar del <a class="wiki" href="../MarcoTransaccional.html">Marco Transaccional</a> de una operación.
</p>
<h2 id="Beneficios">Beneficios</h2>
<p>
Cuando los datos a manejar son simples, es fácil mantener entre pedidos de página la información en la sesión en forma plana, en toba esto lo hace generalmente el CI. Cuando los datos empiezan a ser complejos, fruto del manejo de relaciones en la base de datos, es difícil que mantener estas estructuras en forma manual.
</p>
<p>
La solución a este problema es describir en forma de componentes a las <strong>tablas</strong> y <strong>relaciones</strong> que se van a manipular en la transacción. 
</p>
<p>
La solución que brindan estos componentes son:
</p>
<ul><li>Guardar el estado de los datos que se manejan en la operación. El ci sólo tendrá que guardar en sesión información relacionada con la presentación pero ya no más los datos de la operación.
</li><li>Brindar una API de manipulación de datos orientada a datos tabulares.
</li><li>Brindar un mecanismo de carga y sincronización. Para mantener independencia con el medio, este proceso es guiado por una clase separada llamada <a class="wiki" href="AP.html">Administrador de persistencia</a>, es la que en definitiva forma las query de carga y los comandos update, insert y delete para el caso de una base de datos relacional.
</li></ul><p>
 
</p>
<h2 id="ComportamientoGeneral">Comportamiento General</h2>
<h3 id="Duranteladefinición">Durante la definición</h3>
<ul><li>Se modelan datos tabulares, generalmente tablas de una base relacional. El componente utilizado es el <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/datos_tabla.gif' /> <a class="wiki" href="datos_tabla.html">datos_tabla</a>.
</li><li>Se modelan las relaciones entre estas tabla (utilizando el componente <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/datos_relacion.gif' /> <a class="wiki" href="datos_relacion.html">datos_relacion</a>).
</li><li>Se asigna la relación al <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/multi_etapa.gif' /> <a class="wiki" href="ci.html">CI</a> encargado de la transacción.
</li></ul><p>
<a style="padding:0; border:none" href="../../../attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.html"><img src="../../../raw-attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.png" /></a>
</p>
<h3 id="Durantelaejecución">Durante la ejecución</h3>
<p>
Siempre desde el CI encargado de la transacción:
</p>
<ul><li>Se <strong>cargan datos</strong> en la relación con una restricción (generalmente la clave de la tabla principal que se está editando), en caso del alta de un nuevo registro se resetea la relación (por si estaba cargada con algún dato previamente). 
<div class="code"><pre><span class="cp">&lt;?php</span>
    <span class="k">function</span> <span class="nf">evt__cuadro_personas__seleccion</span><span class="p">(</span><span class="nv">$id</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dep</span><span class="p">(</span><span class="s1">'datos'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">cargar</span><span class="p">(</span><span class="nv">$id</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set_pantalla</span><span class="p">(</span><span class="s1">'edicion'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x">
</span></pre></div></li></ul><ul><li>Los eventos de los distintos elementos de interface (eis) son ruteados hacia el datos_tabla correspondiente. Por ejemplo en la configuración de un formulario se alimenta del datos_tabla que contiene los datos que se quieren manipular, lo mismo sucede cuando se produce la modificación. El siguiente ejemplo <strong>trabaja con un solo registro</strong> por eso la simplicidad de la llamada:
<div class="code"><pre><span class="cp">&lt;?php</span>
    <span class="k">function</span> <span class="nf">conf__formulario</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dep</span><span class="p">(</span><span class="s1">'datos'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">tabla</span><span class="p">(</span><span class="s1">'personas'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">();</span>
    <span class="p">}</span>
    
    <span class="k">function</span> <span class="nf">evt__formulario__modificacion</span><span class="p">(</span><span class="nv">$datos</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dep</span><span class="p">(</span><span class="s1">'datos'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">tabla</span><span class="p">(</span><span class="s1">'personas'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="nv">$datos</span><span class="p">);</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span><span class="x">
</span></pre></div></li></ul><ul><li>Cuando el CI quiere finalizar la transacción (por ejemplo el usuario decide <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/guardar.gif' /> guardar), se pide <strong>sincronizar</strong> el datos_relacion. En este caso se elige volver a la pantalla de selección luego de la sincronización.
<div class="code"><pre><span class="cp">&lt;?php</span>
    <span class="k">function</span> <span class="nf">evt__procesar</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dep</span><span class="p">(</span><span class="s1">'datos'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">sincronizar</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set_pantalla</span><span class="p">(</span><span class="s1">'seleccion'</span><span class="p">);</span>
    <span class="p">}</span>

<span class="cp">?&gt;</span><span class="x">
</span></pre></div></li></ul><p>
Estos son los pasos para escenarios sencillos, para más información sobre los servicios que brindan estos componentes se encuentra en:
</p>
<ul><li><img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/datos_relacion.gif' /> <a class="wiki" href="datos_relacion.html">datos_relacion</a>
</li><li><img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.gif?link=http://desarrollos.siu.edu.ar/toba_trunk/img/objetos/datos_tabla.gif' /> <a class="wiki" href="datos_tabla.html">datos_tabla</a>
</li></ul><p>
Ver el funcionamiento de las clases de persistencia con un <img onerror='alert("No se encuentra la imagen: " + this.src)' style='vertical-align:middle' border=0 src='../../../../../external.html?link=http://desarrollos.siu.edu.ar/toba_editor_trunk/img/referencia.png' /> <strong><a href='../../../../../external.html?link=http://desarrollos.siu.edu.ar/toba_referencia_trunk/aplicacion.php?ai=toba_referencia||2658' title='Navega hacia el ejemplo en el proyecto online de referencia'>Ejemplo de operación</a></strong>
</p>

        
        
      </div>
          <h3>Attachments</h3>
          <ul>
              <li>
      <a href="../../../attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.html" title="View attachment">intro_persistencia.png</a>
      <a href="../../../raw-attachment/wiki/Referencia/Objetos/Persistencia/intro_persistencia.png" title="Download" class="trac-rawlink"><img src="../../../chrome/common/download.png" alt="Download" /></a>
      (<span title="10125 bytes">9.9 KB</span>) - added by <em>seba</em>
      <a class="timeline" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/timeline?from=2006-10-12T11%3A31%3A13-0300&amp;precision=second" title="2006-10-12T11:31:13-0300 in Timeline">4 years</a> ago.
              </li>
          </ul>
    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("../../../pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/Persistencia?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="../../../../../external.html?link=http://trac.edgewall.org/"><img src="../../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">
        Powered by <a href="../../../../../external.html?link=https://repositorio.siu.edu.ar/trac/toba/about"><strong>Trac 0.11.7</strong></a><br />
        By <a href="../../../../../external.html?link=http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right">Creado por SIU<br /><a href="../../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a></p>
    </div>
    <div id="sitefooter">
    </div>
<script type="text/javascript">
if (document.getElementById('link_php')) {
document.getElementById('link_php').onclick = function() {
    location.href = '../../../../../external.html?link=http://desarrollos.siu.edu.ar/toba_editor_trunk/doc/api/index.html';
    return false;
}
document.getElementById('link_js').onclick = function() {
    location.href = '../../../../../external.html?link=http://desarrollos.siu.edu.ar/toba_editor_trunk/doc/api_js/index.html';
    return false;
}
document.getElementById('link_wiki').onclick = function() {
    location.href = '../../Referencia.html';
    return false;
}
}
</script>
  </body>
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>