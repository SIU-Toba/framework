<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
 <title>Referencia/Objetos/datos_relacion - SIU-Toba - Trac</title><link rel="start" href="../../../wiki.html" /><link rel="search" href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" /><link rel="help" href="../../TracGuide.html" /><link rel="stylesheet" href="../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/common/css/wiki.css" type="text/css" /><link rel="icon" href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/favicon.ico" type="image/x-icon" /><link rel="shortcut icon" href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/favicon.ico" type="image/x-icon" /><link rel="alternate" href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/datos_relacion?format=txt" title="Plain Text" type="text/plain" /><style type="text/css">
.wikipage h2 {border-bottom: 1px solid gray;}
</style>
 <script type="text/javascript" src="../../../chrome/common/js/trac.js"></script>
</head>
<body>


<div id="banner">

<div id="header"><a id="logo" href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba"><img src="../../../chrome/site/logo_toba_siu.gif" width="282" height="90" alt="Toba" /></a><hr /></div>

<form id="search" action="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" method="get">
 <div>
  <label for="proj-search">Search:</label>
  <input type="text" id="proj-search" name="q" size="10" accesskey="f" value="" />
  <input type="submit" value="Search" />
  <input type="hidden" name="wiki" value="on" />
  <input type="hidden" name="changeset" value="on" />
  <input type="hidden" name="ticket" value="on" />
 </div>
</form>



<div id="metanav" class="nav"><ul><li class="first"><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/login">Login</a></li><li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/settings">Settings</a></li><li><a href="../../TracGuide.html" accesskey="6">Help/Guide</a></li><li class="last"><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/about" accesskey="9">About Trac</a></li></ul></div>
</div>

<div id="mainnav" class="nav"><ul><li class="active first"><a href="../../../wiki.html" accesskey="1">Wiki</a></li><li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/timeline" accesskey="2">Timeline</a></li><li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/roadmap" accesskey="3">Roadmap</a></li><li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/browser">Browse Source</a></li><li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/report">View Tickets</a></li><li class="last"><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/search" accesskey="4">Search</a></li></ul></div>
<div id="main">




<div id="ctxtnav" class="nav">
 <h2>Wiki Navigation</h2>
 <ul>
  <li><a href="../../../wiki.html">Start Page</a></li>
  <li><a href="../../TitleIndex.html">Title Index</a></li>
  <li><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/RecentChanges">Recent Changes</a></li>
  
   <li class="last"><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/datos_relacion?action=history">Page History</a></li>
  
 </ul>
 <hr />
</div>

<div id="content" class="wiki">

 
  
  
   <div class="wikipage">
    <div id="searchable"><p>
<a href="../../WikiStart.html">Inicio</a> / <a href="../../Referencia.html">Referencia</a> / <a href="../Objetos.html">Objetos</a> / datos_relacion
</p>
<h1 id="Objetodatos_relacion">Objeto datos_relacion</h1>
<p>
Mantiene un conjunto relacionado de <a class="wiki" href="datos_tabla.html">datos_tabla</a>, brindando servicios para cargar y sincronizar esta relación con algún medio de persistencia.
</p>
<h2 id="TiposdeRelaciones">Tipos de Relaciones</h2>
<p>
Entre las tablas se definen relaciones del tipo "tiene como hijo a" (la inversa de "depende de"), esta es la relación que se utiliza para definir las claves foráneas entre las tablas. Por ejemplo si un empleado trabaja en un departamento, el empleado "depende del" departamento (tiene una FK a esta tabla), entonces departamento es la tabla 'padre' y  empleado la tabla 'hijo', esta es la definición de asociaciones 1-N o N-1. Cuando se toma por ejemplo la relación "Un empleado tiene muchas tareas" y las tareas son una entidad en sí mismas ahí se incluye una tercera tabla que es la que permite la relación N-N:
</p>
<p>
(EMPL) 1----&gt;N (EMPL_TAREAS) N&lt;----1 (TAREA)
</p>
<p>
En este caso aunque la relación <i>lógica</i> es entre dos tablas, la normalización requiere la inclusión de una tercera tabla. Como los objetos de persistencia son un reflejo del diseño de tablas también se definen tres tablas y dos relaciones: EMPL es padre de EMPL_TAREAS y TAREA es también padre de EMPL_TAREAS.
</p>
<p>
<a href="../../../attachment/wiki/Referencia/Objetos/datos_relacion/esquema.png" style="padding:0; border:none"><img src="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/attachment/wiki/Referencia/Objetos/datos_relacion/esquema.png?format=raw" alt="Esquema de la relación" title="Esquema de la relación" style="" /></a>
</p>
<h2 id="Definición">Definición</h2>
<ul><li>AP por defecto: Administrador de persistencia a utilizar, ver más abajo la función que cumple.
</li><li>Modo debug: Para facilitar el entendimiento de lo que esta sucediendo en la relación en cualquier punto de la ejecución se brinda un esquema que muestra el contenido actual de cada tabla y las relaciones que existe entre registros particulares. Este modo se puede activar en ejecución (utilizando el método dump_esquema) o en forma estática utilizando esta definición. Si se define en forma estática se muestra el esquema cuando se crea la relacion (al comienzo del request) y otro cuando se destruyo (al final del mismo). El esquema se grafica utilizando el <a class="wiki" href="ei_esquema.html">Objeto ei_esquema</a> en formato SVG (ver requisitos en el objeto).
</li><li>Suspender Constraints: No siempre se puede asegurar que las restricciones de base de datos se cumplan durante toda la sincronización. Existen situaciones en que el orden en el que se ejecutan las distintas sentencias puede incumplir temporalmente alguna restricción. Para estos casos se pueden suspender <i>temporalmente</i> el chequeo de constraints en la base, hasta el final de la transacción.
</li><li>Orden Automático: Tanto la carga como la sincronización siguen un orden llamado 'Orden Topológico' de las tablas en base a las relaciones padre-hijo que existen entre ellas. Este orden no es posible definirlo si existe un ciclo en las relaciones (A es padre de B, este es de padre de..... que es padre de A), en este caso o en caso que el orden topológico no sea el deseado se puede definir uno particular. Cuando el orden automático esta desactivado se toma el orden determinado en la definición de las tablas.
</li><li>Tablas: Se adjuntan los datos tablas que forman parte de la relación, el identificador permite nombrarlas dentro de la relación tanto en la definición como en la definición. Así por ejemplo si se define una tabla 'persona' en la relación, desde el código se la nombre como $relacion-&gt;tabla('persona'). Es posible determinar topes mínimos y máximos de filas que puede tener cada tabla en la relación.
</li><li>Relaciones: Se definen las relaciones padre-hijo entre las tablas, especificando los campos comunes entre las tablas. 
</li></ul><h2 id="Primitivas">Primitivas</h2>
<p>
En general el datos_relación va a estar asociado a un <a class="wiki" href="ci.html">Objeto CI</a>, y es desde allí es donde se consumen las primitivas disponibles. La mejor forma de entender las primitivas es revisando el <strong><a href='../../../../../external.html?link=https://desarrollos2.siu.edu.ar/toba_trunk/doc/api/Objetos/Persistencia/objeto_datos_relacion.html#' target='_blank'>API</a></strong>, a continuación se dan ejemplos a manera de resumen de las primitivas más utilizadas:
</p>
<h3 id="Carga">Carga</h3>
<p>
La forma más común de cargar una relación es a partir de una restricción de las tablas raices (aquellas que no tienen padres), para esto se utiliza el método cargar: <tt>$relacion-&gt;cargar(array('id' =&gt; 8));</tt>, para formas más particulares de cargar la relación ver el 
<a href='../../../../../external.html?link=https://desarrollos2.siu.edu.ar/toba_trunk/doc/api/Objetos/Persistencia/ap_relacion_db.html#' target='_blank'>API del administrador de persistencia</a>.
</p>
<h3 id="Trabajoenmemoria">Trabajo en memoria</h3>
<p>
El trabajo posterior a la carga generalmente se realiza a travez de las <a class="wiki" href="datos_tabla.html">tablas relacionadas</a>, la forma de acceder a un objeto tabla es así: <tt>$relacion-&gt;tabla('nombre_tabla')-&gt;get_filas()</tt>, la principal diferencia radica en que las operaciones sobre las tablas ya no son aisladas sino que trabajan en el <i>contexto</i> de la relación:
</p>
<ul><li>La eliminación de una fila de una tabla padre propaga la eliminación de las filas relacionadas en las tablas hijas.
</li><li>La inserción de una fila en una tabla hija se asocia con el <strong>cursor</strong> de la tabla padre.
</li></ul><p>
El cursor de una tabla marca la fila actualmente editada, por ejemplo una operación edita tareas de empleados, en forma particular en algún momento de la operación se selecciona un empleado particular (supongamos Gomez) y se añaden tareas, el código de agregar una tarea sería algo así:
</p>
<pre class="wiki">$rel-&gt;tabla('empleados')-&gt;set_cursor('gomez');
$rel-&gt;tabla('tareas')-&gt;nueva_fila('nombre' =&gt; 'Limpieza');
$rel-&gt;tabla('tareas')-&gt;nueva_fila('nombre' =&gt; 'Monitoreo');
</pre>
<p>
En lugar de explicitar el empleado en estas llamadas, se asume que estas tareas se asocian con el empleado actual, es decir el cursor actual de la tabla empleados. Esto permite encadenar comportamientos, por ejemplo a nivel de interfaz primero se selecciona un empleado y luego se trabaja sobre el (añadiendo, modificando y quitando propiedades básicas y anexas), en la acción de selección simplemente se explicita el cursor, mientras que en el resto de las acciones no se hace referencia a este empleado, y se asume el seleccionado.
</p>
<h2 id="Másinfo">Más info</h2>
<ul><li><a class="wiki" href="Persistencia.html">Introducción a los objetos de persistencia</a>.
</li></ul></div>
   </div>
   
    <h3 id="tkt-changes-hdr">Attachments</h3>
    <ul class="tkt-chg-list"><li class="tkt-chg-change"><a href="../../../attachment/wiki/Referencia/Objetos/datos_relacion/esquema.png">esquema.png</a> (11.1 kB) -<q>Esquema de la relación</q>, added by seba on 12/28/05 15:54:25.</li>
    </ul>
  
  
  <script type="text/javascript">
   addHeadingLinks(document.getElementById("searchable"));
  </script>
 
 
</div>

<script type="text/javascript">searchHighlight()</script>
<div id="altlinks"><h3>Download in other formats:</h3><ul><li class="first last"><a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/wiki/Referencia/Objetos/datos_relacion?format=txt">Plain Text</a></li></ul></div>

</div>

<div id="footer">
 <hr />
 <a id="tracpowered" href="../../../../../external.html?link=http://trac.edgewall.com/"><img src="../../../chrome/common/trac_logo_mini.png" height="30" width="107"
   alt="Trac Powered"/></a>
 <p class="left">
  Powered by <a href="../../../../../external.html?link=https://desarrollos2.siu.edu.ar/trac/toba/about"><strong>Trac 0.9.2</strong></a><br />
  By <a href="../../../../../external.html?link=http://www.edgewall.com/">Edgewall Software</a>.
 </p>
 <p class="right">
  Creado por el Programa SIU<br /><a href="../../../../../external.html?link=http://www.siu.edu.ar/">http://www.siu.edu.ar</a>
 </p>
</div>



 </body>
</html>

