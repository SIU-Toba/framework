/*
 * FCKeditor - The text editor for internet
 * Copyright (C) 2003-2004 Frederico Caldeira Knabben
 * 
 * Licensed under the terms of the GNU Lesser General Public License:
 * 		http://www.opensource.org/licenses/lgpl-license.php
 * 
 * For further information visit:
 * 		http://www.fckeditor.net/
 * 
 * This file has been compacted for best loading performance.
 * 
 * Version: 2.0 Beta 2
 * Created: 2004-09-10 02:40:08
 */
FCK.ExecuteNamedCommand=function(commandName, commandParameter){FCK.Focus();FCK.EditorDocument.execCommand(commandName, false, commandParameter);FCK.Events.FireEvent('OnSelectionChange');};FCK.GetNamedCommandState=function(commandName){try{if (!FCK.EditorDocument.queryCommandEnabled( commandName )) return FCK_TRISTATE_DISABLED;else return FCK.EditorDocument.queryCommandState(commandName) ? FCK_TRISTATE_ON : FCK_TRISTATE_OFF;}catch (e){return FCK_TRISTATE_OFF;};};FCK.GetNamedCommandValue=function(commandName){var sValue='';var eState=FCK.GetNamedCommandState(commandName);if (eState==FCK_TRISTATE_DISABLED) return null;try{sValue=this.EditorDocument.queryCommandValue(commandName);}catch(e) {};return sValue ? sValue : '';};FCK.CreateLink=function(url){if (url.length==0) FCK.ExecuteNamedCommand('Unlink');else{FCK.ExecuteNamedCommand('CreateLink', "javascript:void(0);/*fckeditortemplink*/");var oLinks=this.EditorDocument.links;for (i=0 ; i < oLinks.length ; i++){if (oLinks[i].href=="javascript:void(0);/*fckeditortemplink*/"){oLinks[i].href=url;return oLinks[i];};};};};FCK.CleanAndPaste=function(html){html=html.replace(/<\/?SPAN[^>]*>/gi, "");html=html.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi, "<$1$3");html=html.replace(/<(\w[^>]*) style="([^"]*)"([^>]*)/gi, "<$1$3");html=html.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi, "<$1$3");html=html.replace(/<\\?\?xml[^>]*>/gi, "");html=html.replace(/<\/?\w+:[^>]*>/gi, "");html=html.replace(/&nbsp;/, " ");var re=new RegExp("(<P)([^>]*>.*?)(<\/P>)","gi");html=html.replace(re, "<div$2</div>");FCK.InsertHtml(html);};FCK.Preview=function(){var oWindow=window.open('', null, 'toolbar=yes,location=yes,status=yes,menubar=yes,scrollbars=yes,resizable=yes');oWindow.document.write(FCK.GetHTML());oWindow.document.close();};FCK.SwitchEditMode=function(){var bWYSIWYG=(FCK.EditMode==FCK_EDITMODE_WYSIWYG);document.getElementById('eWysiwyg').style.display	= bWYSIWYG ? "none" : "";document.getElementById('eSource').style.display	= bWYSIWYG ? "" : "none";if (bWYSIWYG) document.getElementById('eSourceField').value = ( FCKConfig.EnableXHTML && FCKConfig.EnableSourceXHTML ? FCK.GetXHTML() : FCK.GetHTML());else FCK.SetHTML(FCK.GetHTML(), true);FCK.EditMode=bWYSIWYG ? FCK_EDITMODE_SOURCE : FCK_EDITMODE_WYSIWYG;FCK.Focus();FCKToolbarSet.RefreshItemsState();};
FCK._BaseGetNamedCommandState=FCK.GetNamedCommandState;FCK.GetNamedCommandState=function(commandName){switch (commandName){case 'Unlink' : return FCKSelection.HasAncestorNode('A') ? FCK_TRISTATE_OFF : FCK_TRISTATE_DISABLED;default : return FCK._BaseGetNamedCommandState(commandName);};};FCK._BaseExecuteNamedCommand=FCK.ExecuteNamedCommand;FCK.ExecuteNamedCommand=function(commandName, commandParameter){switch (commandName){case 'Print' : FCK.EditorWindow.print();break;case 'Paste' : try			{ if (FCK.Paste() ) FCK._BaseExecuteNamedCommand( 'Paste') ; }catch (e)	{ alert( "Your browser security settings don't permit the editor to automaticaly execute pasting operations. Please use the keyboard for that (Ctrl+V).") ;};break;case 'Cut' : try			{ FCK._BaseExecuteNamedCommand('Cut') ; }catch (e)	{ alert( "Your browser security settings don't permit the editor to automaticaly execute cutting operations. Please use the keyboard for that (Ctrl+X).") ;};break;case 'Copy' : try			{ FCK._BaseExecuteNamedCommand('Copy') ; }catch (e)	{ alert( "Your browser security settings don't permit the editor to automaticaly execute copying operations. Please use the keyboard for that (Ctrl+C).") ;};break;default : FCK._BaseExecuteNamedCommand(commandName, commandParameter);};};FCK.AttachToOnSelectionChange=function(functionPointer){this.Events.AttachEvent('OnSelectionChange', functionPointer);};FCK.Paste=function(){if (FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false;}else if (FCKConfig.AutoDetectPasteFromWord && FCKBrowserInfo.IsIE55OrMore){var sHTML=FCK.GetClipboardHTML();var re=/<\w[^>]* class="?MsoNormal"?/gi;if (re.test( sHTML )){if (confirm( FCKLang["PasteWordConfirm"] )){FCK.CleanAndPaste(sHTML);return false;};};}else return true;};FCK.InsertHtml=function(html){var oSel=FCKSelection.Delete();var oRange=oSel.getRangeAt(0);var oFragment=oRange.createContextualFragment(html);var oLastNode=oFragment.lastChild;oRange.insertNode(oFragment);oRange.setEndAfter(oLastNode);oRange.setStartAfter(oLastNode);oSel.removeAllRanges();oSel=FCK.EditorWindow.getSelection();oSel.addRange(oRange);this.Focus();};FCK.InsertElement=function(element){var oSel=FCKSelection.Delete();var oRange=oSel.getRangeAt(0);oRange.insertNode(element);oRange.setEndAfter(element);oRange.setStartAfter(element);this.Focus();};FCK.PasteAsPlainText=function(){FCKDialog.OpenDialog('FCKDialog_Paste', 'Paste as Plain Text', 'dialog/fck_paste.html', 400, 330, 'PlainText');};FCK.PasteFromWord=function(){FCKDialog.OpenDialog('FCKDialog_Paste', 'Paste from Word', 'dialog/fck_paste.html', 400, 330, 'Word');};FCK.GetClipboardHTML=function(){return '';};
var FCKSelection=new Object();FCK.Selection=FCKSelection;
FCKSelection.GetSelectedElement=function(){var oSel=FCK.EditorWindow.getSelection();if (oSel.rangeCount==1){var oRange=oSel.getRangeAt(0);if (oRange.startContainer==oRange.endContainer && (oRange.endOffset - oRange.startOffset)==1) return oSel.anchorNode.childNodes[ oSel.anchorOffset ];};};FCKSelection.MoveToNode=function(node){var oSel=FCK.EditorWindow.getSelection();for (i=oSel.rangeCount - 1 ; i >=0 ; i--){if (i==0) oSel.getRangeAt(i).selectNodeContents( node);else oSel.removeRange(oSel.getRangeAt(i));};};FCKSelection.HasAncestorNode=function(nodeTagName){var oContainer=this.GetSelectedElement();if (! oContainer && FCK.EditorWindow){try		{ oContainer=FCK.EditorWindow.getSelection().getRangeAt(0).startContainer ; }catch(e){};};while (oContainer){if (oContainer.tagName==nodeTagName) return true;oContainer=oContainer.parentNode;};return false;};FCKSelection.MoveToAncestorNode=function(nodeTagName){var oNode;var oContainer=this.GetSelectedElement();if (! oContainer) oContainer=FCK.EditorWindow.getSelection().getRangeAt(0).startContainer;while (oContainer){if (oContainer.tagName==nodeTagName) return oContainer;oContainer=oContainer.parentNode;};};FCKSelection.Delete=function(){var oSel=FCK.EditorWindow.getSelection();for (var i=0 ; i < oSel.rangeCount ; i++){oSel.getRangeAt(i).deleteContents();};return oSel;}
var FCKPanel=function(){};FCKPanel.prototype.Create=function(){this.PanelDiv=window.parent.document.createElement('DIV');this.PanelDiv.style.visibility='hidden';this.PanelDiv.className='FCK_Panel';this.PanelDiv.style.zIndex=10000;this.PanelDiv.oncontextmenu=function() { return false ;};window.parent.document.body.appendChild(this.PanelDiv);if (this.CreatePanelBody) this.CreatePanelBody(window.parent.document, this.PanelDiv);this.Created=true;};FCKPanel.prototype.Show=function(panelX, panelY){if (! this.Created) this.Create();this.PanelDiv.style.left=panelX + 'px';this.PanelDiv.style.top=panelY + 'px';var oActualWindow=FCK.EditorWindow;while (oActualWindow){oActualWindow.document.addEventListener('click', this._OnDocumentClick, false);if (oActualWindow !=oActualWindow.parent) oActualWindow=oActualWindow.parent;else if (oActualWindow.opener==null) oActualWindow=oActualWindow.opener;else break;};this.PanelDiv.style.visibility='';FCK.ActivePanel=this;};FCKPanel.prototype._OnDocumentClick=function(event){if (! FCK.ActivePanel) return;var e=event.target;while (e){if (e==FCK.ActivePanel.PanelDiv) return;e=e.parentNode;};FCK.ActivePanel.Hide();};FCKPanel.prototype.Hide=function(){this.PanelDiv.style.visibility='hidden';this.PanelDiv.style.left=this.PanelDiv.style.top='1px';delete FCK.ActivePanel;}
var FCKColorPanel=function(setColorFunction){this.SetColorFunction=setColorFunction;};FCKColorPanel.prototype=new FCKPanel;FCKColorPanel.prototype.CreatePanelBody=function(targetDocument, targetDiv){function CreateSelectionDiv(){var oDiv=targetDocument.createElement("DIV");oDiv.className='ColorDeselected';oDiv.onmouseover=function() { this.className='ColorSelected' ; };oDiv.onmouseout=function() { this.className='ColorDeselected' ; };return oDiv;};var oTable=targetDocument.createElement("TABLE");oTable.cellPadding=0;oTable.cellSpacing=0;oTable.border=0;var oDiv=CreateSelectionDiv();oDiv.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">\ <tr>\ <td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>\ <td nowrap width="100%" align="center" unselectable="on">Automatic</td>\ </tr>\ </table>';oDiv.Panel=this;oDiv.onclick=function(){this.className='ColorDeselected';this.Panel.SetColorFunction('');this.Panel.Hide();};var oCell=oTable.insertRow(-1).insertCell(-1);oCell.colSpan=8;oCell.appendChild(oDiv);var aColors=FCKConfig.FontColors.split(',');var iCounter=0;while (iCounter < aColors.length){var oRow=oTable.insertRow(-1);for (var i=0 ; i < 8 && iCounter < aColors.length ; i++, iCounter++){var oDiv=CreateSelectionDiv();oDiv.Color=aColors[iCounter];oDiv.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #' + aColors[iCounter] + '"></div></div>';oDiv.Panel=this;oDiv.onclick=function(){this.className='ColorDeselected';this.Panel.SetColorFunction('#' + this.Color);this.Panel.Hide();};oCell=oRow.insertCell(-1);oCell.appendChild(oDiv);};};var oDiv=CreateSelectionDiv();oDiv.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">More Colors...</td></tr></table>';oDiv.Panel=this;oDiv.onclick=function(){this.className='ColorDeselected';this.Panel.Hide();FCKDialog.OpenDialog('FCKDialog_Color', 'Select a Color', 'dialog/fck_colorselector.html', 400, 330, this.Panel.SetColorFunction);};var oCell=oTable.insertRow(-1).insertCell(-1);oCell.colSpan=8;oCell.appendChild(oDiv);targetDiv.appendChild(oTable);}
var FCKTableHandler=new Object();FCKTableHandler.InsertRow=function(){var oRow=FCKSelection.MoveToAncestorNode("TR");if (!oRow) return;var oNewRow=oRow.cloneNode(true);oRow.parentNode.insertBefore(oNewRow, oRow);FCKTableHandler.ClearRow(oRow);};FCKTableHandler.DeleteRows=function(row){if (!row) row=FCKSelection.MoveToAncestorNode("TR");if (!row) return;var oTable=FCKTools.GetElementAscensor(row, 'TABLE');if (oTable.rows.length==1){FCKTableHandler.DeleteTable(oTable);return;};row.parentNode.removeChild(row);};FCKTableHandler.DeleteTable=function(table){if (!table) table=FCKSelection.MoveToAncestorNode("TABLE");if (!table) return;table.parentNode.removeChild(table);};FCKTableHandler.InsertColumn=function(){var oCell=FCKSelection.MoveToAncestorNode("TD");if (!oCell) return;var oTable=FCKTools.GetElementAscensor(oCell, 'TABLE');var iIndex=oCell.cellIndex + 1;for (var i=0 ; i < oTable.rows.length ; i++){var oRow=oTable.rows[i];if (oRow.cells.length < iIndex) continue;oCell=FCK.EditorDocument.createElement('TD');oCell.innerHTML='&nbsp;';var oBaseCell=oRow.cells[iIndex];if (oBaseCell){oRow.insertBefore(oCell, oBaseCell);}else{oRow.appendChild(oCell);};};};FCKTableHandler.DeleteColumns=function(){var oCell=FCKSelection.MoveToAncestorNode("TD");if (!oCell) return;var oTable=FCKTools.GetElementAscensor(oCell, 'TABLE');var iIndex=oCell.cellIndex;for (var i=oTable.rows.length - 1 ; i >=0 ; i--){var oRow=oTable.rows[i];if (iIndex==0 && oRow.cells.length==1){FCKTableHandler.DeleteRows(oRow);continue;};if (oRow.cells[iIndex]) oRow.removeChild(oRow.cells[iIndex]);};};FCKTableHandler.InsertCell=function(){var oCell=FCKSelection.MoveToAncestorNode("TD");if (!oCell) return;var oNewCell=FCK.EditorDocument.createElement("TD");oNewCell.innerHTML="&nbsp;";if (oCell.cellIndex==oCell.parentNode.cells.lenght - 1){oCell.parentNode.appendChild(oNewCell);}else{oCell.parentNode.insertBefore(oNewCell, oCell.nextSibling);};};FCKTableHandler.DeleteCell=function(cell){if (cell.parentNode.cells.length==1){FCKTableHandler.DeleteRows(FCKTools.GetElementAscensor( cell, 'TR' ));return;};cell.parentNode.removeChild(cell);};FCKTableHandler.DeleteCells=function(){var aCells=FCKTableHandler.GetSelectedCells();for (var i=aCells.length - 1 ; i >=0  ; i--){FCKTableHandler.DeleteCell(aCells[i]);};};FCKTableHandler.MergeCells=function(){alert('Command not implemented.');};FCKTableHandler.SplitCell=function(){alert('Command not implemented.');};FCKTableHandler.ClearRow=function(tr){var aCells=tr.cells;for (var i=0 ; i < aCells.length ; i++){aCells[i].innerHTML='&nbsp;';};}
FCKTableHandler.GetSelectedCells=function(){var aCells=new Array();var oSelection=FCK.EditorWindow.getSelection();if (oSelection.rangeCount==1 && oSelection.anchorNode.nodeType==3){var oParent=FCKTools.GetElementAscensor(oSelection.anchorNode, 'TD');if (oParent){aCells[0]=oParent;return aCells;};};for (var i=0 ; i < oSelection.rangeCount ; i++){var oRange=oSelection.getRangeAt(i);var oCell=oRange.startContainer.childNodes[ oRange.startOffset ];if (oCell.tagName=='TD') aCells[aCells.length]=oCell;};return aCells;};
var FCKNamedCommand=function(commandName){this.Name=commandName;};FCKNamedCommand.prototype.Execute=function(){FCK.ExecuteNamedCommand(this.Name);};FCKNamedCommand.prototype.GetState=function(){return FCK.GetNamedCommandState(this.Name);};
var FCKDialogCommand=function(name, title, url, width, height, getStateFunction, getStateParam){this.Name=name;this.Title=title;this.Url=url;this.Width=width;this.Height=height;this.GetStateFunction=getStateFunction;this.GetStateParam=getStateParam;};FCKDialogCommand.prototype.Execute=function(){FCKDialog.OpenDialog('FCKDialog_' + this.Name , this.Title, this.Url, this.Width, this.Height);};FCKDialogCommand.prototype.GetState=function(){if (this.GetStateFunction){return this.GetStateFunction(this.GetStateParam);}else{return FCK_TRISTATE_OFF;};};var FCKUndefinedCommand=function(){this.Name='Undefined';};FCKUndefinedCommand.prototype.Execute=function(){alert('Command not implemented.');};FCKUndefinedCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;};var FCKFontNameCommand=function(){this.Name='FontName';};FCKFontNameCommand.prototype.Execute=function(fontName){if (fontName==null || fontName==""){}else{FCK.ExecuteNamedCommand('FontName', fontName);};};FCKFontNameCommand.prototype.GetState=function(){return FCK.GetNamedCommandValue('FontName');};var FCKFontSizeCommand=function(){this.Name='FontSize';};FCKFontSizeCommand.prototype.Execute=function(fontSize){if (typeof( fontSize )=='string' ) fontSize = parseInt(fontSize);if (fontSize==null || fontSize==''){FCK.ExecuteNamedCommand('FontSize', 3);}else{FCK.ExecuteNamedCommand('FontSize', fontSize);};};FCKFontSizeCommand.prototype.GetState=function(){return FCK.GetNamedCommandValue('FontSize');};var FCKFormatBlockCommand=function(){this.Name='FormatBlock';};FCKFormatBlockCommand.prototype.Execute=function(formatName){if (formatName==null || formatName==''){FCK.ExecuteNamedCommand('FormatBlock', '<P>');}else{FCK.ExecuteNamedCommand('FormatBlock', formatName);};};FCKFormatBlockCommand.prototype.GetState=function(){return FCK.GetNamedCommandValue('FormatBlock');};var FCKPreviewCommand=function(){this.Name='Preview';};FCKPreviewCommand.prototype.Execute=function(){FCK.Preview();};FCKPreviewCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;};var FCKSaveCommand=function(){this.Name='Save';};FCKSaveCommand.prototype.Execute=function(){var oForm=FCK.LinkedField.form;oForm.submit();};FCKSaveCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;};var FCKNewPageCommand=function(){this.Name='NewPage';};FCKNewPageCommand.prototype.Execute=function(){FCK.SetHTML('');};FCKNewPageCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;};var FCKSourceCommand=function(){this.Name="Source";};FCKSourceCommand.prototype.Execute=function(){FCK.SwitchEditMode();};FCKSourceCommand.prototype.GetState=function(){return (FCK.EditMode==FCK_EDITMODE_WYSIWYG ? FCK_TRISTATE_OFF : FCK_TRISTATE_ON);}
var FCKTextColorCommand=function(type){this.Name=type=='ForeColor' ? 'TextColor' : 'BGColor';this.Type=type;this._Panel=new FCKColorPanel(this.SetColor);this._Panel.Create();};FCKTextColorCommand.prototype.Execute=function(panelX, panelY){FCK._ActiveColorPanelType=this.Type;this._Panel.Show(panelX, panelY);};FCKTextColorCommand.prototype.SetColor=function(color){if (FCK._ActiveColorPanelType=='ForeColor') FCK.ExecuteNamedCommand('ForeColor', color);else if (FCKBrowserInfo.IsGecko) FCK.ExecuteNamedCommand('hilitecolor', color);else FCK.ExecuteNamedCommand('BackColor', color);delete FCK._ActiveColorPanelType;};FCKTextColorCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;}
var FCKPastePlainTextCommand=function(){this.Name='PasteText';};FCKPastePlainTextCommand.prototype.Execute=function(){FCK.PasteAsPlainText();};FCKPastePlainTextCommand.prototype.GetState=function(){return FCK.GetNamedCommandState('Paste');};
var FCKPasteWordCommand=function(){this.Name='PasteWord';};FCKPasteWordCommand.prototype.Execute=function(){FCK.PasteFromWord();};FCKPasteWordCommand.prototype.GetState=function(){return FCK.GetNamedCommandState('Paste');};
var FCKTableCommand=function(command){this.Name=command;};FCKTableCommand.prototype.Execute=function(){switch (this.Name){case 'TableInsertRow' : FCKTableHandler.InsertRow();break;case 'TableDeleteRows' : FCKTableHandler.DeleteRows();break;case 'TableInsertColumn' : FCKTableHandler.InsertColumn();break;case 'TableDeleteColumns' : FCKTableHandler.DeleteColumns();break;case 'TableInsertCell' : FCKTableHandler.InsertCell();break;case 'TableDeleteCells' : FCKTableHandler.DeleteCells();break;case 'TableMergeCells' : FCKTableHandler.MergeCells();break;case 'TableSplitCell' : FCKTableHandler.SplitCell();break;default : alert('Unknown command "' + this.Name + '".');};};FCKTableCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF;}
var FCKCommands=new Object();var sNamedCommands=[ 'Cut','Copy','Paste','Print','Find','SelectAll','RemoveFormat','Unlink','Undo','Redo', 'Bold','Italic','Underline','StrikeThrough','Subscript','Superscript', 'JustifyLeft','JustifyCenter','JustifyRight','JustifyFull','Outdent','Indent', 'InsertOrderedList','InsertUnorderedList','InsertHorizontalRule'];for (i=0 ; i < sNamedCommands.length ; i++){FCKCommands[ sNamedCommands[i] ]=new FCKNamedCommand(sNamedCommands[i]);};FCKCommands['Link']			= new FCKDialogCommand( 'Link'			, FCKLang.DlgLnkWindowTitle, 'dialog/fck_link.html'	, 400, 330, FCK.GetNamedCommandState, 'CreateLink' );FCKCommands['About']		= new FCKDialogCommand( 'About'			, FCKLang.About, 'dialog/fck_about.html'	, 400, 330 );FCKCommands['Image']		= new FCKDialogCommand( 'Image'			, 'Image Properties', 'dialog/fck_image.html'		, 450, 400, FCK.GetNamedCommandState, 'InsertImage' );FCKCommands['Table']		= new FCKDialogCommand( 'Table'			, 'Table Properties', 'dialog/fck_table.html'		, 400, 250 );FCKCommands['TableProp']	= new FCKDialogCommand( 'Table'			, 'Table Properties', 'dialog/fck_table.html?Parent', 400, 250 );FCKCommands['SpecialChar']	= new FCKDialogCommand( 'SpecialChar'	, 'Select Character', 'dialog/fck_specialchar.html'	, 400, 300, FCK.GetNamedCommandState, 'InsertImage' );FCKCommands['Smiley']		= new FCKDialogCommand( 'Smiley'		, FCKLang.DlgSmileyTitle, 'dialog/fck_smiley.html'	, FCKConfig.SmileyWindowWidth, FCKConfig.SmileyWindowHeight, FCK.GetNamedCommandState, 'InsertImage' );FCKCommands['FontName']		= new FCKFontNameCommand();FCKCommands['FontSize']		= new FCKFontSizeCommand();FCKCommands['FontFormat']	= new FCKFormatBlockCommand();FCKCommands['Source']		= new FCKSourceCommand();FCKCommands['Preview']		= new FCKPreviewCommand();FCKCommands['Save']			= new FCKSaveCommand();FCKCommands['NewPage']		= new FCKNewPageCommand();FCKCommands['TextColor']	= new FCKTextColorCommand('ForeColor');FCKCommands['BGColor']		= new FCKTextColorCommand('BackColor');FCKCommands['PasteText']	= new FCKPastePlainTextCommand();FCKCommands['PasteWord']	= new FCKPasteWordCommand();FCKCommands['TableInsertRow']		= new FCKTableCommand('TableInsertRow');FCKCommands['TableDeleteRows']		= new FCKTableCommand('TableDeleteRows');FCKCommands['TableInsertColumn']	= new FCKTableCommand('TableInsertColumn');FCKCommands['TableDeleteColumns']	= new FCKTableCommand('TableDeleteColumns');FCKCommands['TableInsertCell']		= new FCKTableCommand('TableInsertCell');FCKCommands['TableDeleteCells']		= new FCKTableCommand('TableDeleteCells');FCKCommands['TableMergeCells']		= new FCKTableCommand('TableMergeCells');FCKCommands['TableSplitCell']		= new FCKTableCommand('TableSplitCell');FCKCommands['Undefined']	= new FCKUndefinedCommand();
var FCKToolbarButton=function(commandName, label, tooltip, style, sourceView){this.Command=FCKCommands[ commandName ];this.Label=label ? label : commandName;this.Tooltip=tooltip ? tooltip : (label ? label : commandName);this.Style=style ? style : FCK_TOOLBARITEM_ONLYICON;this.SourceView=sourceView ? true : false;this.State=FCK_UNKNOWN;};FCKToolbarButton.prototype.CreateInstance=function(parentToolbar){this.DOMDiv=document.createElement('div');this.DOMDiv.className='TB_Button_Off';this.DOMDiv.FCKToolbarButton=this;this.DOMDiv.onmouseover=function(){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED){this.className='TB_Button_On';};};this.DOMDiv.onmouseout=function(){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED &&  this.FCKToolbarButton.State !=FCK_TRISTATE_ON){this.className='TB_Button_Off';};};this.DOMDiv.onclick=function(){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED) this.FCKToolbarButton.Command.Execute();return false;};var sClass;switch (this.Style){case FCK_TOOLBARITEM_ONLYICON : sClass='TB_ButtonType_Icon';break;case FCK_TOOLBARITEM_ONLYTEXT : sClass='TB_ButtonType_Text';break;case FCK_TOOLBARITEM_ICONTEXT : sClass='';break;};this.DOMDiv.innerHTML='<table title="' + this.Tooltip + '" class="' + sClass + '" cellspacing="0" cellpadding="0" border="0" unselectable="on">' + '<tr>' + '<td class="TB_Icon" unselectable="on"><img src="' + FCKConfig.SkinPath + 'toolbar/button.' + this.Command.Name.toLowerCase() + '.gif" width="21" height="21" style="VISIBILITY: hidden" onload="this.style.visibility = \'\';" unselectable="on"></td>' + '<td class="TB_Text" unselectable="on">' + this.Label + '</td>' + '</tr>' + '</table>';var oCell=parentToolbar.DOMRow.insertCell(-1);oCell.appendChild(this.DOMDiv);this.RefreshState();};FCKToolbarButton.prototype.RefreshState=function(){var eState;if (FCK.EditMode==FCK_EDITMODE_SOURCE && ! this.SourceView) eState=FCK_TRISTATE_DISABLED;else eState=this.Command.GetState();if (eState==this.State) return;this.State=eState;switch (this.State){case FCK_TRISTATE_ON : this.DOMDiv.className='TB_Button_On';break;case FCK_TRISTATE_OFF : this.DOMDiv.className='TB_Button_Off';break;default : this.DOMDiv.className='TB_Button_Disabled';break;};}
var FCKToolbarCombo=function(commandName, label, itemsValues, itemsNames, tooltip, style, firstIsBlank, itemsSeparator, sourceView){this.Command=FCKCommands[ commandName ];this.Label=label ? label : commandName;this.Tooltip=tooltip ? tooltip : (label ? label : commandName);this.Style=style ? style : FCK_TOOLBARITEM_ICONTEXT;this.SourceView=sourceView ? true : false;this.State=FCK_UNKNOWN;this.ItemsValues=itemsValues;this.ItemsNames=itemsNames ? itemsNames : itemsValues;this.ItemsSeparator=itemsSeparator ? itemsSeparator : ';';this.FirstIsBlank=firstIsBlank !=null ? firstIsBlank : true;};FCKToolbarCombo.prototype.CreateInstance=function(parentToolbar){this.DOMDiv=document.createElement('div');this.DOMDiv.className='TB_Combo_Off';var sClass;switch (this.Style){case FCK_TOOLBARITEM_ONLYICON : sClass='TB_ButtonType_Icon';break;case FCK_TOOLBARITEM_ONLYTEXT : sClass='TB_ButtonType_Text';break;case FCK_TOOLBARITEM_ICONTEXT : sClass='';break;};this.DOMDiv.innerHTML='<table class="' + sClass + '" cellspacing="0" cellpadding="0" border="0" unselectable="on">' + '<tr>' + '<td class="TB_Text" unselectable="on" nowrap>' + this.Label + '</td>' + '<td unselectable="on"><select title="' + this.Tooltip + '"></select></td>' + '</tr>' + '</table>';this.SelectElement=this.DOMDiv.firstChild.firstChild.firstChild.childNodes.item(1).firstChild;this.SelectElement.FCKToolbarCombo=this;this.SelectElement.onchange=function(){this.FCKToolbarCombo.Command.Execute(this.value);return false;};var oCell=parentToolbar.DOMRow.insertCell(-1);oCell.appendChild(this.DOMDiv);this.RefreshItems();this.RefreshState();};FCKToolbarCombo.prototype.RefreshItems=function(){var aNames=FCKTools.GetResultingArray(this.ItemsNames, this.ItemsSeparator);var aValues=FCKTools.GetResultingArray(this.ItemsValues, this.ItemsSeparator);FCKTools.RemoveAllSelectOptions(this.SelectElement);if (this.FirstIsBlank) FCKTools.AddSelectOption(document, this.SelectElement, '', '');for (var i=0 ; i < aValues.length ; i++){FCKTools.AddSelectOption(document, this.SelectElement, aNames[i], aValues[i]);};};FCKToolbarCombo.prototype.RefreshState=function(){var eState;if (FCK.EditMode==FCK_EDITMODE_SOURCE && ! this.SourceView){eState=FCK_TRISTATE_DISABLED;this.SelectElement.value='';}else{var sValue=this.Command.GetState();FCKTools.SelectNoCase(this.SelectElement, sValue ? sValue : '', '');eState=sValue==null ? FCK_TRISTATE_DISABLED : FCK_TRISTATE_ON;};if (eState==this.State) return;this.State=eState;this.DOMDiv.className=(eState==FCK_TRISTATE_ON ? 'TB_Combo_Off' : 'TB_Combo_Disabled');this.SelectElement.disabled=(eState==FCK_TRISTATE_DISABLED);};
var FCKToolbarPanelButton=function(commandName, label, tooltip, style){this.Command=FCKCommands[ commandName ];this.Label=label ? label : commandName;this.Tooltip=tooltip ? tooltip : (label ? label : commandName);this.Style=style ? style : FCK_TOOLBARITEM_ONLYICON;this.State=FCK_UNKNOWN;if (this.Command==null) alert('Unknown command name "' + commandName + '"');};FCKToolbarPanelButton.prototype.CreateInstance=function(parentToolbar){this.DOMDiv=document.createElement('div');this.DOMDiv.className='TB_Button_Off';this.DOMDiv.FCKToolbarButton=this;this.DOMDiv.onmouseover=function(){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED){this.className='TB_Button_On';};};this.DOMDiv.onmouseout=function(){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED &&  this.FCKToolbarButton.State !=FCK_TRISTATE_ON){this.className='TB_Button_Off';};};this.DOMDiv.onclick=function(ev){if (this.FCKToolbarButton.State !=FCK_TRISTATE_DISABLED) this.FCKToolbarButton.HandleOnClick(this.FCKToolbarButton, ev);if (ev) ev.stopPropagation();return false;};var sClass;switch (this.Style){case FCK_TOOLBARITEM_ONLYICON : sClass='TB_ButtonType_Icon';break;case FCK_TOOLBARITEM_ONLYTEXT : sClass='TB_ButtonType_Text';break;case FCK_TOOLBARITEM_ICONTEXT : sClass='';break;};this.DOMDiv.innerHTML='<table title="' + this.Tooltip + '" class="' + sClass + '" cellspacing="0" cellpadding="0" border="0" unselectable="on">' + '<tr>' + '<td class="TB_Icon" unselectable="on"><img src="' + FCKConfig.SkinPath + 'toolbar/button.' + this.Command.Name.toLowerCase() + '.gif" width="21" height="21" style="VISIBILITY: hidden" onload="this.style.visibility = \'\';" unselectable="on"></td>' + '<td class="TB_Text" unselectable="on">' + this.Label + '</td>' + '<td class="TB_ButtonArrow" unselectable="on"><img src="' + FCKConfig.SkinPath + 'images/toolbar.buttonarrow.gif" width="5" height="3"></td>' + '</tr>' + '</table>';var oCell=parentToolbar.DOMRow.insertCell(-1);oCell.appendChild(this.DOMDiv);this.RefreshState();};FCKToolbarPanelButton.prototype.RefreshState=FCKToolbarButton.prototype.RefreshState;
FCKToolbarPanelButton.prototype.HandleOnClick=function(panelButton, ev){var e=panelButton.DOMDiv;var oDivCoords=FCKTools.GetElementPosition(e);var oFrmCoords=FCKTools.GetElementPosition(window.frameElement);var iPanelX=oDivCoords.X + oFrmCoords.X;var iPanelY=oDivCoords.Y + oFrmCoords.Y + e.offsetHeight;panelButton.Command.Execute(iPanelX,iPanelY);}
var FCKToolbarItems=new Object();FCKToolbarItems['Source']		= new FCKToolbarButton( 'Source', 'Source', null, FCK_TOOLBARITEM_ICONTEXT, true );FCKToolbarItems['Save']			= new FCKToolbarButton( 'Save', null, null, null, true  );FCKToolbarItems['NewPage']		= new FCKToolbarButton( 'NewPage', null, null, null, true  );FCKToolbarItems['Preview']		= new FCKToolbarButton( 'Preview', null, null, null, true  );FCKToolbarItems['About']		= new FCKToolbarButton( 'About', FCKLang.About );FCKToolbarItems['Cut']			= new FCKToolbarButton( 'Cut', FCKLang.Cut, null, null, true );FCKToolbarItems['Copy']			= new FCKToolbarButton( 'Copy', FCKLang.Copy, null, null, true );FCKToolbarItems['Paste']		= new FCKToolbarButton( 'Paste', FCKLang.Paste, null, null, true );FCKToolbarItems['PasteText']	= new FCKToolbarButton( 'PasteText', FCKLang.PasteText );FCKToolbarItems['PasteWord']	= new FCKToolbarButton( 'PasteWord', FCKLang.PasteWord );FCKToolbarItems['Print']		= new FCKToolbarButton( 'Print', null, null, null, true );FCKToolbarItems['Undo']			= new FCKToolbarButton( 'Undo', null, null, null, true );FCKToolbarItems['Redo']			= new FCKToolbarButton( 'Redo', null, null, null, true );FCKToolbarItems['Find']			= new FCKToolbarButton( 'Find', null, null, null, true );FCKToolbarItems['SelectAll']	= new FCKToolbarButton( 'SelectAll', 'Select All', null, null, true );FCKToolbarItems['RemoveFormat']	= new FCKToolbarButton( 'RemoveFormat', 'Remove Format' );FCKToolbarItems['Unlink']		= new FCKToolbarButton( 'Unlink' );FCKToolbarItems['Bold']			= new FCKToolbarButton( 'Bold' );FCKToolbarItems['Italic']		= new FCKToolbarButton( 'Italic' );FCKToolbarItems['Underline']	= new FCKToolbarButton( 'Underline' );FCKToolbarItems['StrikeThrough']= new FCKToolbarButton( 'StrikeThrough', 'Strike Through' );FCKToolbarItems['Subscript']	= new FCKToolbarButton( 'Subscript' );FCKToolbarItems['Superscript']	= new FCKToolbarButton( 'Superscript' );FCKToolbarItems['OrderedList']	= new FCKToolbarButton( 'InsertOrderedList', 'Ordered List', 'Insert/Remove Ordered List' );FCKToolbarItems['UnorderedList']= new FCKToolbarButton( 'InsertUnorderedList', 'Unordered List', 'Insert/Remove Unordered List' );FCKToolbarItems['Outdent']		= new FCKToolbarButton( 'Outdent' );FCKToolbarItems['Indent']		= new FCKToolbarButton( 'Indent' );FCKToolbarItems['Link']			= new FCKToolbarButton( 'Link', 'Link', 'Create/Edit Link' );FCKToolbarItems['Unlink']		= new FCKToolbarButton( 'Unlink', 'Remove Link' );FCKToolbarItems['Image']		= new FCKToolbarButton( 'Image', 'Image', 'Insert/Edit Image' );FCKToolbarItems['Table']		= new FCKToolbarButton( 'Table', 'Table', 'Create/Edit Table' );FCKToolbarItems['SpecialChar']	= new FCKToolbarButton( 'SpecialChar', 'Special Character', 'Insert Special Character' );FCKToolbarItems['Smiley']		= new FCKToolbarButton( 'Smiley', 'Smiley', 'Insert Smiley' );FCKToolbarItems['Rule']			= new FCKToolbarButton( 'InsertHorizontalRule', 'Horizontal Rule', 'Insert Horizontal Rule' );FCKToolbarItems['JustifyLeft']	= new FCKToolbarButton( 'JustifyLeft', 'Align Left' );FCKToolbarItems['JustifyCenter']= new FCKToolbarButton( 'JustifyCenter', 'Center' );FCKToolbarItems['JustifyRight']	= new FCKToolbarButton( 'JustifyRight', 'Align Right' );FCKToolbarItems['JustifyFull']	= new FCKToolbarButton( 'JustifyFull', 'Justify' );FCKToolbarItems['FontName']		= new FCKToolbarCombo( 'FontName', FCKLang['Font'], FCKConfig.FontNames, FCKConfig.FontNames );FCKToolbarItems['FontSize']		= new FCKToolbarCombo( 'FontSize', FCKLang['FontSize'], '1;2;3;4;5;6;7', 'xx-small;x-small;small;medium;large;x-large;xx-large' );FCKToolbarItems['FontFormat']	= new FCKToolbarCombo( 'FontFormat', FCKLang['FontFormat'], '<P>;<DIV>;<H1>;<H2>', 'Normal (P);Normal (DIV);Heading 1;Heading 2' );FCKToolbarItems['TextColor']	= new FCKToolbarPanelButton( 'TextColor' );FCKToolbarItems['BGColor']		= new FCKToolbarPanelButton( 'BGColor' );
var FCKToolbar=function(){this.Items=new Array();this.DOMTable=document.createElement('table');this.DOMTable.className='TB_Toolbar';with (this.DOMTable){style.styleFloat=style.cssFloat=FCKLang.Dir=='rtl' ? 'right' : 'left';cellPadding=0;cellSpacing=0;border=0;};this.DOMRow=this.DOMTable.insertRow(-1);var oCell=this.DOMRow.insertCell(-1);oCell.className='TB_Start';oCell.innerHTML='<img src="' + FCKConfig.SkinPath + 'images/toolbar.start.gif" width="7" height="21" style="VISIBILITY: hidden" onload="this.style.visibility = \'\';" unselectable="on">';FCKToolbarSet.DOMElement.appendChild(this.DOMTable);};FCKToolbar.prototype.AddItem=function(toolbarItem){this.Items[ this.Items.length ]=toolbarItem;toolbarItem.CreateInstance(this);};FCKToolbar.prototype.AddSeparator=function(){var oCell=this.DOMRow.insertCell(-1);oCell.unselectable='on';oCell.innerHTML='<img src="' + FCKConfig.SkinPath + 'images/toolbar.separator.gif" width="5" height="21" style="VISIBILITY: hidden" onload="this.style.visibility = \'\';" unselectable="on">';};FCKToolbar.prototype.AddTerminator=function(){var oCell=this.DOMRow.insertCell(-1);oCell.className='TB_End';oCell.innerHTML='<img src="' + FCKConfig.SkinPath + 'images/toolbar.end.gif" width="12" height="21" style="VISIBILITY: hidden" onload="this.style.visibility = \'\';" unselectable="on">';};
var FCKToolbarSet=new Object();FCKToolbarSet.Toolbars=new Array();FCKToolbarSet.Expand=function(){document.getElementById('Collapsed').style.display = 'none';document.getElementById('Expanded').style.display = '';if (! FCKBrowserInfo.IsIE){window.setTimeout("window.onresize()", 1);};};FCKToolbarSet.Collapse=function(){document.getElementById('Collapsed').style.display = '';document.getElementById('Expanded').style.display = 'none';if (! FCKBrowserInfo.IsIE){window.setTimeout("window.onresize()", 1);};};FCKToolbarSet.Restart=function(){if (!FCKConfig.ToolbarCanCollapse || FCKConfig.ToolbarStartExpanded) this.Expand();else this.Collapse();document.getElementById('CollapseHandle').style.display = FCKConfig.ToolbarCanCollapse ? '' : 'none';};FCKToolbarSet.Load=function(toolbarSetName){this.DOMElement=document.getElementById('eToolbar');var ToolbarSet=FCKConfig.ToolbarSets[toolbarSetName];if (! ToolbarSet){alert('Toolbar set "' + toolbarSetName + '" doesn\'t exist.');return;};this.Toolbars=new Array();for (var x=0 ; x < ToolbarSet.length ; x++){var oToolbar=new FCKToolbar();for (var j=0 ; j < ToolbarSet[x].length ; j++){var sItem=ToolbarSet[x][j];if (sItem=='-') oToolbar.AddSeparator();else{var oItem=FCKToolbarItems[sItem];if (oItem) oToolbar.AddItem(oItem);else alert('Unknown toolbar item name "' + sItem + "'");};};oToolbar.AddTerminator();this.Toolbars[ this.Toolbars.length ]=oToolbar;};this.Redraw();};FCKToolbarSet.Redraw=function(){};FCKToolbarSet.RefreshItemsState=function(){for (var i=0 ; i < FCKToolbarSet.Toolbars.length ; i++){var oToolbar=FCKToolbarSet.Toolbars[i];for (var j=0 ; j < oToolbar.Items.length ; j++){oToolbar.Items[j].RefreshState();};};};
var FCKDialog=new Object();FCKDialog.OpenDialog=function(dialogName, dialogTitle, dialogPage, width, height, customValue){var oDialogInfo=new Object();oDialogInfo.Title=dialogTitle;oDialogInfo.Page=dialogPage;oDialogInfo.Editor=window;oDialogInfo.CustomValue=customValue;var sUrl=FCKConfig.BasePath + 'fckdialog.html';this.Show(oDialogInfo, dialogName, sUrl, width, height);};
FCKDialog.Show=function(dialogInfo, dialogName, pageUrl, dialogWidth, dialogHeight){var iTop=(screen.height - dialogHeight) / 2;var iLeft=(screen.width  - dialogWidth)  / 2;var sOption="location=no,menubar=no,resizable=no,toolbar=no,dependent=yes" + ",width="  + dialogWidth + ",height=" + dialogHeight + ",top="  + iTop + ",left=" + iLeft;var oWindow=window.open('', 'FCKEditorDialog', sOption, true);oWindow.moveTo(iLeft, iTop);oWindow.resizeTo(dialogWidth, dialogHeight);oWindow.focus();oWindow.location.href=pageUrl;oWindow.dialogArguments=dialogInfo;this.Window=oWindow;window.top.captureEvents(Event.CLICK | Event.MOUSEDOWN | Event.MOUSEUP | Event.FOCUS);window.top.parent.addEventListener('mousedown', this.CheckFocus, true);window.top.parent.addEventListener('mouseup', this.CheckFocus, true);window.top.parent.addEventListener('click', this.CheckFocus, true);window.top.parent.addEventListener('focus', this.CheckFocus, true);};FCKDialog.CheckFocus=function(){if (FCKDialog.Window && !FCKDialog.Window.closed){FCKDialog.Window.focus();return false;}else{window.top.releaseEvents(Event.CLICK | Event.MOUSEDOWN | Event.MOUSEUP | Event.FOCUS);window.top.parent.removeEventListener('onmousedown', FCKDialog.CheckFocus, true);window.top.parent.removeEventListener('mouseup', FCKDialog.CheckFocus, true);window.top.parent.removeEventListener('click', FCKDialog.CheckFocus, true);window.top.parent.removeEventListener('onfocus', FCKDialog.CheckFocus, true);};};
var FCKContextMenuItem=function(contextMenu, commandName, label, hasIcon){this.ContextMenu=contextMenu;this.Command=FCKCommands[ commandName ];this.Label=label ? label : commandName;this.HasIcon=hasIcon ? true : false;};FCKContextMenuItem.prototype.CreateTableRow=function(targetTable){this._Row=targetTable.insertRow(-1);this._Row.className='CM_Disabled';this._Row.FCKContextMenuItem=this;this._Row.onmouseover=function(){if (this.className !='CM_Disabled') this.className='CM_Over';};this._Row.onmouseout=function(){if (this.className !='CM_Disabled') this.className='CM_Option';};this._Row.onclick=function(){this.FCKContextMenuItem.ContextMenu.Hide();this.FCKContextMenuItem.Command.Execute();return false;};var oCell=this._Row.insertCell(-1);oCell.className='CM_Icon';if (this.HasIcon ) oCell.innerHTML='<img alt="" src="' + FCKConfig.SkinPath + 'toolbar/button.' + this.Command.Name.toLowerCase() + '.gif" width="21" height="20" unselectable="on">';oCell=this._Row.insertCell(-1);oCell.className='CM_Label';oCell.unselectable='on';oCell.noWrap=true;oCell.innerHTML=this.Label;};FCKContextMenuItem.prototype.SetVisible=function(isVisible){this._Row.style.display=isVisible ? '' : 'none';};FCKContextMenuItem.prototype.RefreshState=function(){switch (this.Command.GetState()){case FCK_TRISTATE_ON : case FCK_TRISTATE_OFF : this._Row.className='CM_Option';break;default : this._Row.className='CM_Disabled';break;};};
var FCKContextMenuSeparator=function(){};FCKContextMenuSeparator.prototype.CreateTableRow=function(targetTable){this._Row=targetTable.insertRow(-1);this._Row.className='CM_Separator';var oCell=this._Row.insertCell(-1);oCell.className='CM_Icon';oCell=this._Row.insertCell(-1);oCell.className='CM_Label';oCell.innerHTML='<div></div>';};FCKContextMenuSeparator.prototype.SetVisible=function(isVisible){this._Row.style.display=isVisible ? '' : 'none';};FCKContextMenuSeparator.prototype.RefreshState=function(){};
var FCKContextMenuGroup=function(){this.IsVisible=true;this.Items=new Array();this.ValidationFunction=null;};FCKContextMenuGroup.prototype.Add=function(contextMenuItem){this.Items[ this.Items.length ]=contextMenuItem;};FCKContextMenuGroup.prototype.CreateTableRows=function(table){for (var i=0 ; i < this.Items.length ; i++){this.Items[i].CreateTableRow(table);};};FCKContextMenuGroup.prototype.SetVisible=function(isVisible){for (var i=0 ; i < this.Items.length ; i++){this.Items[i].SetVisible(isVisible);};this.IsVisible=isVisible;};FCKContextMenuGroup.prototype.RefreshState=function(){if (! this.IsVisible) return;for (var i=0 ; i < this.Items.length ; i++){this.Items[i].RefreshState();};}
var FCKContextMenu=new Object();FCKContextMenu._IsLoaded=false;FCKContextMenu.Reload=function(){this._Div=this._Document.createElement('DIV');this._Div.className='CM_ContextMenu';this._Div.style.position='absolute';this._Div.style.visibility='hidden';this._Document.body.appendChild(this._Div);var oTable=this._Document.createElement('TABLE');oTable.cellSpacing=0;oTable.cellPadding=0;oTable.border=0;this._Div.appendChild(oTable);this.Groups=new Object();this.Groups['Generic'] = new FCKContextMenuGroup();with (this.Groups['Generic']){Add(new FCKContextMenuItem( this, 'Cut'	, FCKLang['Cut']	, true ));Add(new FCKContextMenuItem( this, 'Copy'	, FCKLang['Copy']	, true ));Add(new FCKContextMenuItem( this, 'Paste'	, FCKLang['Paste']	, true ));};this.Groups['Link'] = new FCKContextMenuGroup();with (this.Groups['Link']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'Link'	, FCKLang['EditLink']	, true ));Add(new FCKContextMenuItem( this, 'Unlink'	, FCKLang['RemoveLink']	, true ));};this.Groups['TableCell'] = new FCKContextMenuGroup();with (this.Groups['TableCell']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'TableInsertRow', FCKLang["InsertRow"], true ));Add(new FCKContextMenuItem( this, 'TableDeleteRows', FCKLang["DeleteRows"], true ));Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'TableInsertColumn', FCKLang["InsertColumn"], true ));Add(new FCKContextMenuItem( this, 'TableDeleteColumns', FCKLang["DeleteColumns"], true ));Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'TableInsertCell', FCKLang["InsertCell"], true ));Add(new FCKContextMenuItem( this, 'TableDeleteCells', FCKLang["DeleteCells"], true ));Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'TableProp', FCKLang["TableProperties"], true ));};this.Groups['Table'] = new FCKContextMenuGroup();with (this.Groups['Table']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'Table', FCKLang["TableProperties"], true ));};this.Groups['Image'] = new FCKContextMenuGroup();with (this.Groups['Image']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'Image', FCKLang["ImageProperties"], true ));};this.Groups['Select'] = new FCKContextMenuGroup();with (this.Groups['Select']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'Undefined', "Selection Field Properties" ));};this.Groups['Textarea'] = new FCKContextMenuGroup();with (this.Groups['Textarea']){Add(new FCKContextMenuSeparator());Add(new FCKContextMenuItem( this, 'Undefined', "Textarea Properties" ));};for (var o in this.Groups){this.Groups[o].CreateTableRows(oTable);};this._IsLoaded=true;};FCKContextMenu.RefreshState=function(){var oTag=FCKSelection.GetSelectedElement();var sTagName;if (oTag){sTagName=oTag.tagName;};this.Groups['Link'].SetVisible( FCK.GetNamedCommandState( 'Unlink' ) != FCK_TRISTATE_DISABLED );this.Groups['TableCell'].SetVisible( sTagName != 'TABLE' && FCKSelection.HasAncestorNode('TABLE') );this.Groups['Table'].SetVisible( sTagName == 'TABLE' );this.Groups['Image'].SetVisible( sTagName == 'IMG' );this.Groups['Select'].SetVisible( sTagName == 'SELECT' );this.Groups['Textarea'].SetVisible( sTagName == 'TEXTAREA' );for (var o in this.Groups){this.Groups[o].RefreshState();};};
FCKTools.AppendStyleSheet(window.parent.document, FCKConfig.SkinPath + 'fck_contextmenu.css');FCKContextMenu.Show=function(x, y){if (! this._Document){this._Document=window.parent.document;};if (!this._IsLoaded){this.Reload();this._Div.style.zIndex=10000;this._Div.oncontextmenu=function() { return false ;};};this.RefreshState();var oCoordsA=FCKTools.GetElementPosition(FCK.EditorWindow.frameElement);var oCoordsB=FCKTools.GetElementPosition(window.frameElement);x +=oCoordsA.X + oCoordsB.X;y +=oCoordsA.Y + oCoordsB.Y;var iXSpace=x + this._Div.offsetWidth - this._Div.ownerDocument.defaultView.innerWidth;var iYSpace=y + this._Div.offsetHeight - this._Div.ownerDocument.defaultView.innerHeight;if (iXSpace > 0) x -=this._Div.offsetWidth;if (iYSpace > 0) y -=this._Div.offsetHeight;this._Div.style.left=x + 'px';this._Div.style.top=y + 'px';var oActualWindow=FCK.EditorWindow;while (oActualWindow){oActualWindow.document.addEventListener('click', FCKContextMenu._OnDocumentClick, false);if (oActualWindow !=oActualWindow.parent) oActualWindow=oActualWindow.parent;else if (oActualWindow.opener==null) oActualWindow=oActualWindow.opener;else break;};this._Div.style.visibility='';};FCKContextMenu._OnDocumentClick=function(event){var e=event.target;while (e){if (e==FCKContextMenu._Div) return;e=e.parentNode;};FCKContextMenu.Hide();};FCKContextMenu.Hide=function(){this._Div.style.visibility='hidden';this._Div.style.left=this._Div.style.top='1px';}
if (FCKConfig.ForcePasteAsPlainText) FCK.Events.AttachEvent("OnPaste", FCK.Paste);FCKToolbarSet.Name=FCKURLParams['Toolbar'] || 'Default';FCKToolbarSet.Load(FCKToolbarSet.Name);FCKToolbarSet.Restart();FCK.AttachToOnSelectionChange(FCKToolbarSet.RefreshItemsState);FCK.Config=FCKConfig;FCK.ToolbarSet=FCKToolbarSet;FCK.SetStatus(FCK_STATUS_COMPLETE);if (typeof( window.parent.FCKeditor_OnComplete )=='function') window.parent.FCKeditor_OnComplete(FCK);
